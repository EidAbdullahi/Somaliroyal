<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROYAL | Premium Islamic Lifestyle & Fragrances</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Playfair Display', 'serif'],
                        arabic: ['Amiri', 'serif'],
                    },
                    colors: {
                        royal: '#D4AF37',
                        'royal-dark': '#B8941F',
                        'royal-light': '#F4E4BC',
                        dark: '#0a0a0a',
                        'dark-light': '#111111',
                        'dark-lighter': '#1a1a1a',
                        oud: '#3D2817',
                        'oud-light': '#5C4033',
                        'islamic-green': '#0F4C3A',
                        'prayer-green': '#1B5E20',
                        'ivory': '#FFFFF0',
                        'pearl': '#F0EAD6',
                    }
                }
            }
        }
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #0a0a0a; 
            color: #ffffff; 
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        .font-display { font-family: 'Playfair Display', serif; }
        .font-arabic { font-family: 'Amiri', serif; }
        
        /* Modern Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #D4AF37; }
        
        /* Advanced Glassmorphism */
        .glass { 
            background: rgba(212, 175, 55, 0.03); 
            backdrop-filter: blur(20px) saturate(180%); 
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(212, 175, 55, 0.08); 
        }
        
        .glass-strong { 
            background: rgba(10, 10, 10, 0.85); 
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid rgba(212, 175, 55, 0.05); 
        }
        
        /* Animated Gradient Text */
        .text-gradient { 
            background: linear-gradient(135deg, #D4AF37 0%, #F4E4BC 50%, #D4AF37 100%); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            background-clip: text; 
            background-size: 200% auto; 
            animation: shimmer 4s linear infinite; 
        }
        
        @keyframes shimmer { 
            0% { background-position: -200% center; } 
            100% { background-position: 200% center; } 
        }
        
        /* Modern Gold Border with Glow */
        .gold-border { 
            border: 1px solid rgba(212, 175, 55, 0.15); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .gold-border:hover { 
            border-color: rgba(212, 175, 55, 0.4); 
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.15), inset 0 0 20px rgba(212, 175, 55, 0.05);
        }
        
        /* Modern Product Card */
        .product-card { 
            position: relative; 
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
            background: linear-gradient(180deg, rgba(255,255,255,0.02) 0%, transparent 100%);
            border-radius: 1rem;
            overflow: hidden;
        }
        
        .product-card:hover { 
            transform: translateY(-12px); 
            background: linear-gradient(180deg, rgba(212,175,55,0.03) 0%, transparent 100%);
        }
        
        /* Modern Media Container */
        .product-media-container { 
            position: relative; 
            overflow: hidden; 
            background: linear-gradient(135deg, #111 0%, #1a1a1a 100%); 
            border-radius: 0.875rem; 
            aspect-ratio: 4/5;
        }
        
        .product-poster { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2;
        }
        
        .product-card:hover .product-poster {
            transform: scale(1.05);
        }
        
        /* Video Wrapper Modern */
        .video-wrapper { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            opacity: 0; 
            transition: opacity 0.5s ease; 
            z-index: 3;
            background: #000;
        }
        
        .video-wrapper.active { 
            opacity: 1; 
            z-index: 4; 
        }
        
        .tiktok-iframe { 
            width: 100%; 
            height: 100%; 
            border: none; 
            object-fit: cover; 
        }
        
        /* Modern Loading Spinner */
        .video-loading { 
            position: absolute; 
            inset: 0; 
            background: linear-gradient(135deg, rgba(212,175,55,0.1) 0%, rgba(61,40,23,0.2) 100%); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            opacity: 0; 
            transition: opacity 0.3s; 
            z-index: 5; 
            pointer-events: none; 
        }
        
        .video-loading.active { opacity: 1; }
        
        .loading-spinner { 
            width: 40px; 
            height: 40px; 
            border: 2px solid rgba(255,255,255,0.1); 
            border-top-color: #D4AF37; 
            border-right-color: #3D2817; 
            border-radius: 50%; 
            animation: spin 0.8s linear infinite; 
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Modern Play Button */
        .video-facade-btn { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%) scale(0.9); 
            width: 72px; 
            height: 72px; 
            background: linear-gradient(135deg, rgba(212,175,55,0.9) 0%, rgba(61,40,23,0.9) 100%); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #fff; 
            font-size: 1.5rem; 
            z-index: 6; 
            opacity: 0; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            cursor: pointer; 
            border: 2px solid rgba(255, 255, 255, 0.2); 
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .product-card:hover .video-facade-btn { 
            opacity: 1; 
            transform: translate(-50%, -50%) scale(1); 
        }
        
        .video-facade-btn:hover { 
            transform: translate(-50%, -50%) scale(1.1); 
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.4); 
        }
        
        .video-facade-btn.playing { 
            opacity: 0; 
            pointer-events: none; 
        }
        
        /* Modern Duration Badge */
        .video-duration { 
            position: absolute; 
            bottom: 1rem; 
            right: 1rem; 
            background: rgba(0, 0, 0, 0.6); 
            color: #D4AF37; 
            padding: 0.5rem 1rem; 
            border-radius: 9999px; 
            font-size: 0.75rem; 
            font-weight: 600; 
            z-index: 6; 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
            border: 1px solid rgba(212, 175, 55, 0.2); 
            backdrop-filter: blur(4px);
            letter-spacing: 0.05em;
        }
        
        /* Modern Product Actions */
        .product-actions { 
            position: absolute; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            padding: 1.5rem; 
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 60%, transparent 100%); 
            display: flex; 
            gap: 0.75rem; 
            opacity: 0; 
            transform: translateY(20px); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 10; 
        }
        
        .product-card:hover .product-actions { 
            opacity: 1; 
            transform: translateY(0); 
        }
        
        .action-btn { 
            flex: 1; 
            padding: 0.875rem; 
            border-radius: 0.75rem; 
            font-weight: 600; 
            font-size: 0.875rem; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 0.5rem; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: none; 
            cursor: pointer;
            letter-spacing: 0.02em;
        }
        
        .action-btn-primary { 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            color: #000; 
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        
        .action-btn-primary:hover { 
            background: linear-gradient(135deg, #F4E4BC 0%, #D4AF37 100%); 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4); 
        }
        
        .action-btn-secondary { 
            background: rgba(255,255,255,0.08); 
            color: #fff; 
            border: 1px solid rgba(212, 175, 55, 0.2); 
            backdrop-filter: blur(10px);
        }
        
        .action-btn-secondary:hover { 
            background: rgba(212, 175, 55, 0.15); 
            border-color: rgba(212, 175, 55, 0.4); 
            transform: translateY(-2px);
        }
        
        /* Modern Quick Add Button */
        .quick-add-btn { 
            position: absolute; 
            top: 1rem; 
            right: 4rem; 
            width: 44px; 
            height: 44px; 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #000; 
            font-size: 1.25rem; 
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 10; 
            border: 2px solid rgba(212, 175, 55, 0.5); 
            opacity: 0; 
            transform: scale(0.8) rotate(-90deg); 
        }
        
        .product-card:hover .quick-add-btn { 
            opacity: 1; 
            transform: scale(1) rotate(0deg); 
        }
        
        .quick-add-btn:hover { 
            transform: scale(1.1) rotate(90deg); 
            box-shadow: 0 6px 25px rgba(212, 175, 55, 0.5); 
        }
        
        /* Modern Wishlist Button */
        .wishlist-btn { 
            position: absolute; 
            top: 1rem; 
            left: 4rem; 
            width: 44px; 
            height: 44px; 
            background: rgba(255, 255, 255, 0.08); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #fff; 
            font-size: 1.25rem; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 10; 
            border: 1px solid rgba(255, 255, 255, 0.15); 
            backdrop-filter: blur(10px);
            opacity: 0; 
            transform: scale(0.8); 
        }
        
        .product-card:hover .wishlist-btn { 
            opacity: 1; 
            transform: scale(1); 
        }
        
        .wishlist-btn:hover { 
            background: rgba(220, 38, 38, 0.9); 
            border-color: rgba(220, 38, 38, 0.4); 
            transform: scale(1.1); 
        }
        
        .wishlist-btn.active { 
            background: rgba(220, 38, 38, 0.9); 
            color: #fff; 
        }
        
        /* Modern Sidebars */
        .cart-sidebar, .wishlist-sidebar { 
            transform: translateX(100%); 
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
            background: rgba(17, 17, 17, 0.98);
            backdrop-filter: blur(20px);
        }
        
        .cart-sidebar.open, .wishlist-sidebar.open { 
            transform: translateX(0); 
        }
        
        /* Modern Toast */
        .toast { 
            position: fixed; 
            bottom: 100px; 
            left: 50%; 
            transform: translateX(-50%) translateY(100px) scale(0.9); 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            color: #000; 
            padding: 1rem 2rem; 
            border-radius: 9999px; 
            font-weight: 700; 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            box-shadow: 0 20px 50px rgba(212, 175, 55, 0.3); 
            z-index: 100; 
            opacity: 0; 
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .toast.show { 
            opacity: 1; 
            transform: translateX(-50%) translateY(0) scale(1); 
        }
        
        /* Modern Badges */
        .product-badge { 
            position: absolute; 
            top: 1rem; 
            left: 1rem; 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            color: #000; 
            padding: 0.5rem 1rem; 
            border-radius: 9999px; 
            font-size: 0.7rem; 
            font-weight: 800; 
            text-transform: uppercase; 
            letter-spacing: 0.1em; 
            z-index: 10; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .product-badge.sale { 
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); 
            color: #fff; 
        }
        
        .product-badge.limited { 
            background: linear-gradient(135deg, #3D2817 0%, #5C4033 100%); 
            color: #fff; 
        }
        
        .product-badge.new { 
            background: linear-gradient(135deg, #0F4C3A 0%, #1B5E20 100%); 
            color: #fff; 
        }
        
        /* Modern Modal */
        .modal { 
            opacity: 0; 
            visibility: hidden; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            backdrop-filter: blur(10px);
        }
        
        .modal.active { 
            opacity: 1; 
            visibility: visible; 
        }
        
        /* Modern Size Selector */
        .size-btn { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1.5px solid rgba(212, 175, 55, 0.2);
            background: transparent;
            color: #fff;
        }
        
        .size-btn:hover { 
            border-color: rgba(212, 175, 55, 0.5); 
            background: rgba(212, 175, 55, 0.05);
            transform: translateY(-2px);
        }
        
        .size-btn.selected { 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            color: #000; 
            border-color: #D4AF37; 
            font-weight: 700; 
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        
        /* Modern WhatsApp Float */
        .whatsapp-float { 
            position: fixed; 
            bottom: 2rem; 
            right: 2rem; 
            z-index: 50; 
            animation: float 4s ease-in-out infinite; 
        }
        
        @keyframes float { 
            0%, 100% { transform: translateY(0); } 
            50% { transform: translateY(-15px); } 
        }
        
        /* Modern Reveal Animation */
        .reveal { 
            opacity: 0; 
            transform: translateY(40px); 
            transition: all 1s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        
        .reveal.active { 
            opacity: 1; 
            transform: translateY(0); 
        }
        
        /* Modern Cart Item */
        .cart-item { 
            animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
        }
        
        .cart-item:hover {
            border-color: rgba(212, 175, 55, 0.2);
            background: rgba(255,255,255,0.04);
        }
        
        @keyframes slideIn { 
            from { opacity: 0; transform: translateX(30px); } 
            to { opacity: 1; transform: translateX(0); } 
        }
        
        /* Modern Quantity Buttons */
        .qty-btn { 
            width: 36px; 
            height: 36px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            background: rgba(212, 175, 55, 0.08); 
            border-radius: 0.5rem; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(212, 175, 55, 0.15);
            color: #fff;
        }
        
        .qty-btn:hover { 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            color: #000; 
            transform: scale(1.1); 
            border-color: #D4AF37;
        }
        
        /* Modern Category Pills */
        .category-pill { 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1.5px solid rgba(212, 175, 55, 0.15); 
            position: relative; 
            overflow: hidden;
            background: transparent;
        }
        
        .category-pill::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: -100%; 
            width: 100%; 
            height: 100%; 
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.2), transparent); 
            transition: left 0.6s; 
        }
        
        .category-pill:hover::before { left: 100%; }
        
        .category-pill:hover { 
            border-color: rgba(212, 175, 55, 0.4); 
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.1);
        }
        
        .category-pill.active { 
            background: linear-gradient(135deg, #D4AF37 0%, #B8941F 100%); 
            color: #000; 
            border-color: #D4AF37; 
            font-weight: 700; 
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
            transform: translateY(-2px);
        }
        
        /* Modern Crown Animation */
        .crown-icon { 
            display: inline-block; 
            animation: gentleFloat 3s ease-in-out infinite; 
        }
        
        @keyframes gentleFloat { 
            0%, 100% { transform: translateY(0) rotate(0deg); } 
            50% { transform: translateY(-5px) rotate(5deg); } 
        }
        
        /* Modern Royal Glow */
        .royal-glow { 
            box-shadow: 0 0 60px rgba(212, 175, 55, 0.15), 0 0 100px rgba(212, 175, 55, 0.05);
        }
        
        /* Modern TikTok Modal */
        .tiktok-modal { 
            position: fixed; 
            inset: 0; 
            background: rgba(0, 0, 0, 0.95); 
            z-index: 100; 
            display: none; 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(20px);
        }
        
        .tiktok-modal.active { 
            display: flex; 
            animation: fadeIn 0.4s ease; 
        }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: scale(0.95); } 
            to { opacity: 1; transform: scale(1); } 
        }
        
        .tiktok-modal iframe { 
            max-width: 90%; 
            max-height: 90%; 
            border-radius: 1.5rem; 
            border: 1px solid rgba(212, 175, 55, 0.2); 
            box-shadow: 0 0 80px rgba(212, 175, 55, 0.2); 
        }
        
        .tiktok-modal-close { 
            position: absolute; 
            top: 2rem; 
            right: 2rem; 
            width: 56px; 
            height: 56px; 
            background: linear-gradient(135deg, #D4AF37 0%, #3D2817 100%); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #fff; 
            font-size: 1.5rem; 
            cursor: pointer; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 2px solid rgba(255, 255, 255, 0.2); 
            z-index: 10; 
        }
        
        .tiktok-modal-close:hover { 
            transform: scale(1.1) rotate(90deg); 
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.5); 
        }
        
        /* Modern Image Loading */
        .img-loading { 
            filter: blur(20px); 
            transform: scale(1.1); 
        }
        
        .img-loaded { 
            filter: blur(0); 
            transform: scale(1); 
            transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        
        /* Modern Sticky Nav */
        #category-nav { 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        
        #category-nav.sticky-active { 
            background: rgba(10, 10, 10, 0.95); 
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            backdrop-filter: blur(20px);
        }
        
        /* Modern Price Tag */
        .price-tag { 
            position: relative; 
            display: inline-block;
            font-variant-numeric: tabular-nums;
        }
        
        .price-tag::after { 
            content: ''; 
            position: absolute; 
            bottom: -2px; 
            left: 0; 
            width: 0; 
            height: 2px; 
            background: linear-gradient(90deg, #D4AF37, transparent); 
            transition: width 0.4s ease; 
        }
        
        .product-card:hover .price-tag::after { 
            width: 100%; 
        }
        
        /* Modern Color Swatch */
        .color-swatch { 
            width: 28px; 
            height: 28px; 
            border-radius: 50%; 
            border: 2px solid transparent; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            position: relative; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .color-swatch:hover { 
            transform: scale(1.2); 
            border-color: #D4AF37; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .color-swatch.selected { 
            border-color: #D4AF37; 
            box-shadow: 0 0 0 3px #0a0a0a, 0 0 0 5px #D4AF37, 0 4px 15px rgba(0,0,0,0.3); 
            transform: scale(1.1);
        }
        
        /* Smooth Scroll */
        html { 
            scroll-behavior: smooth; 
        }
        
        /* Focus Visible */
        *:focus-visible { 
            outline: 2px solid #D4AF37; 
            outline-offset: 3px; 
        }
        
        /* Hide Scrollbar */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Islamic Pattern Background */
        .geometric-pattern {
            background-color: #0a0a0a;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23D4AF37' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        /* Modern Mobile Optimizations */
        @media (max-width: 640px) {
            .product-card:hover { transform: translateY(-6px); }
            .video-facade-btn { 
                width: 56px; 
                height: 56px; 
                font-size: 1.25rem; 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1); 
            }
            .product-actions { 
                opacity: 1; 
                transform: translateY(0); 
                padding: 1rem; 
                background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) 100%);
            }
            .action-btn { padding: 0.75rem; font-size: 0.8rem; }
            .quick-add-btn, .wishlist-btn { 
                opacity: 1; 
                transform: scale(1); 
                width: 36px; 
                height: 36px; 
                font-size: 1rem; 
            }
            .quick-add-btn { right: 3.5rem; }
            .wishlist-btn { left: 3.5rem; }
            .product-badge { font-size: 0.65rem; padding: 0.4rem 0.8rem; }
            .video-duration { font-size: 0.7rem; padding: 0.4rem 0.8rem; }
            .whatsapp-float { bottom: 1.5rem; right: 1.5rem; }
            .whatsapp-float button { width: 56px; height: 56px; font-size: 1.75rem; }
            .toast { padding: 0.875rem 1.5rem; font-size: 0.875rem; bottom: 90px; }
            .cart-sidebar, .wishlist-sidebar { width: 100%; }
        }
        
        @media (max-width: 768px) {
            .font-display.text-6xl { font-size: 2.5rem; }
            .font-display.text-5xl { font-size: 2rem; }
            .font-display.text-4xl { font-size: 1.75rem; }
            .font-display.text-3xl { font-size: 1.5rem; }
        }
        
        @media (hover: none) {
            .product-card:hover .video-facade-btn { opacity: 1; }
            .video-facade-btn { opacity: 1; }
        }
        
        body { max-width: 100vw; overflow-x: hidden; }
        
        @supports (padding: max(0px)) {
            .fixed.bottom-0, .fixed.bottom-2, .whatsapp-float { 
                padding-bottom: max(1rem, env(safe-area-inset-bottom)); 
            }
            .fixed.top-0 { padding-top: max(0px, env(safe-area-inset-top)); }
            .fixed.left-0 { padding-left: max(0px, env(safe-area-inset-left)); }
            .fixed.right-0 { padding-right: max(0px, env(safe-area-inset-right)); }
        }
        
        /* Modern Grid View Toggle */
        .view-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
        }
        
        .view-btn.active {
            background: linear-gradient(135deg, rgba(212,175,55,0.2) 0%, rgba(212,175,55,0.1) 100%);
            border-color: rgba(212, 175, 55, 0.3);
            color: #D4AF37;
        }
        
        /* Modern Search Bar */
        .search-input {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            background: rgba(255,255,255,0.05);
            border-color: rgba(212, 175, 55, 0.4);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.1);
        }
        
        /* Modern Stock Status */
        .stock-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .stock-status.low {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border-color: rgba(245, 158, 11, 0.2);
        }
        
        .stock-status.out {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.2);
        }
        
        /* Modern Hero Stats */
        .hero-stat {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(212, 175, 55, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hero-stat:hover {
            transform: translateY(-5px);
            border-color: rgba(212, 175, 55, 0.3);
            background: rgba(212, 175, 55, 0.05);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        /* Modern Navigation Links */
        .nav-link {
            position: relative;
            padding: 0.5rem 0;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #D4AF37, transparent);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        /* Modern Button Hover Effects */
        .btn-primary {
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        /* Modern Footer Links */
        .footer-link {
            position: relative;
            display: inline-block;
        }
        
        .footer-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 1px;
            background: #D4AF37;
            transition: width 0.3s ease;
        }
        
        .footer-link:hover::after {
            width: 100%;
        }
    </style>
</head>
<body class="antialiased geometric-pattern">
    <!-- Modern Navigation -->
    <nav class="fixed w-full z-50 glass-strong transition-all duration-500" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16 sm:h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center cursor-pointer group" onclick="window.scrollTo(0,0)">
                    <span class="font-display text-2xl sm:text-3xl font-bold tracking-wider text-white flex items-center gap-3 group-hover:text-royal transition-colors duration-300">
                        <i class="fas fa-mosque text-royal crown-icon text-2xl sm:text-3xl"></i>
                        <span class="hidden sm:inline tracking-[0.2em]">ROYAL</span>
                    </span>
                    <div class="hidden sm:flex items-center gap-2 ml-4">
                        <span class="px-3 py-1 bg-royal/10 text-royal text-xs font-bold rounded-full border border-royal/20 group-hover:bg-royal group-hover:text-black transition-all duration-300">ISLAMIC</span>
                        <span class="px-3 py-1 bg-gradient-to-r from-oud to-oud-light text-white text-xs font-bold rounded-full flex items-center gap-1">
                            <i class="fas fa-star-and-crescent text-[10px]"></i>Halal
                        </span>
                    </div>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a onclick="filterCategory('all')" class="nav-link text-sm font-medium text-gray-300 hover:text-royal transition-colors cursor-pointer">All</a>
                    <a onclick="filterCategory('formal')" class="nav-link text-sm font-medium text-gray-300 hover:text-royal transition-colors cursor-pointer">Formal Wear</a>
                    <a onclick="filterCategory('perfumes')" class="nav-link text-sm font-medium text-gray-300 hover:text-royal transition-colors cursor-pointer">Perfumes</a>
                    <a onclick="filterCategory('shoes')" class="nav-link text-sm font-medium text-gray-300 hover:text-royal transition-colors cursor-pointer">Shoes</a>
                    <a onclick="filterCategory('attars')" class="nav-link text-sm font-medium text-gray-300 hover:text-royal transition-colors cursor-pointer">Attars</a>
                    <a onclick="filterCategory('essentials')" class="nav-link text-sm font-medium text-gray-300 hover:text-royal transition-colors cursor-pointer">Essentials</a>
                </div>

                <!-- Actions -->
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <button onclick="toggleSearch()" class="w-10 h-10 rounded-full flex items-center justify-center text-gray-300 hover:text-royal hover:bg-white/5 transition-all duration-300" aria-label="Search">
                        <i class="fas fa-search text-lg"></i>
                    </button>
                    <button onclick="toggleWishlist()" class="w-10 h-10 rounded-full flex items-center justify-center text-gray-300 hover:text-royal hover:bg-white/5 transition-all duration-300 relative" aria-label="Wishlist">
                        <i class="fas fa-heart text-lg"></i>
                        <span id="wishlist-count" class="absolute -top-1 -right-1 bg-gradient-to-r from-red-500 to-red-600 text-white text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center transform scale-0 transition-transform duration-300 shadow-lg">0</span>
                    </button>
                    <button onclick="toggleCart()" class="w-10 h-10 rounded-full flex items-center justify-center text-gray-300 hover:text-royal hover:bg-white/5 transition-all duration-300 relative" aria-label="Cart">
                        <i class="fas fa-shopping-bag text-xl"></i>
                        <span id="cart-count" class="absolute -top-1 -right-1 bg-gradient-to-r from-royal to-royal-dark text-black text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center transform scale-0 transition-transform duration-300 shadow-lg shadow-royal/30">0</span>
                    </button>
                    <button class="md:hidden w-10 h-10 rounded-full flex items-center justify-center text-gray-300 hover:text-royal hover:bg-white/5 transition-all duration-300" onclick="toggleMobileMenu()" aria-label="Menu">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Modern Search Bar -->
        <div id="search-bar" class="hidden border-t border-white/5 bg-dark-light/95 backdrop-blur-xl px-4 py-4 animate-fade-up">
            <div class="max-w-3xl mx-auto relative">
                <input type="text" id="search-input" placeholder="Search thobes, perfumes, attars, prayer items..." 
                    class="search-input w-full rounded-full px-6 py-3.5 pl-14 text-white placeholder-gray-500 text-sm sm:text-base focus:outline-none"
                    onkeyup="filterProducts()">
                <i class="fas fa-search absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-500 text-lg"></i>
                <button onclick="toggleSearch()" class="absolute right-5 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-royal transition-colors w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/5">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- Modern Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden glass-strong border-t border-white/5">
            <div class="px-4 py-6 space-y-1">
                <a onclick="filterCategory('all'); toggleMobileMenu()" class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-royal hover:bg-white/5 rounded-xl cursor-pointer transition-all duration-300">All Products</a>
                <a onclick="filterCategory('formal'); toggleMobileMenu()" class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-royal hover:bg-white/5 rounded-xl cursor-pointer transition-all duration-300 flex items-center gap-3"><i class="fas fa-user-tie w-6 text-center"></i> Formal Wear</a>
                <a onclick="filterCategory('perfumes'); toggleMobileMenu()" class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-royal hover:bg-white/5 rounded-xl cursor-pointer transition-all duration-300 flex items-center gap-3"><i class="fas fa-spray-can w-6 text-center"></i> Perfumes</a>
                <a onclick="filterCategory('shoes'); toggleMobileMenu()" class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-royal hover:bg-white/5 rounded-xl cursor-pointer transition-all duration-300 flex items-center gap-3"><i class="fas fa-shoe-prints w-6 text-center"></i> Footwear</a>
                <a onclick="filterCategory('attars'); toggleMobileMenu()" class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-royal hover:bg-white/5 rounded-xl cursor-pointer transition-all duration-300 flex items-center gap-3"><i class="fas fa-oil-can w-6 text-center"></i> Attars & Oils</a>
                <a onclick="filterCategory('essentials'); toggleMobileMenu()" class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-royal hover:bg-white/5 rounded-xl cursor-pointer transition-all duration-300 flex items-center gap-3"><i class="fas fa-pray w-6 text-center"></i> Essentials</a>
            </div>
        </div>
    </nav>

    <!-- Modern Wishlist Sidebar -->
    <div id="wishlist-overlay" class="fixed inset-0 bg-black/60 z-50 hidden backdrop-blur-sm transition-opacity duration-300" onclick="toggleWishlist()"></div>
    <div id="wishlist-sidebar" class="fixed right-0 top-0 h-full w-full sm:w-[420px] z-50 wishlist-sidebar overflow-y-auto border-l border-royal/10 shadow-2xl">
        <div class="p-6 border-b border-white/5 flex justify-between items-center sticky top-0 bg-[#111]/95 backdrop-blur-xl z-10">
            <h2 class="font-display text-2xl font-bold flex items-center gap-3">
                <i class="fas fa-heart text-red-500"></i>
                Wishlist 
                <span id="wishlist-total-items" class="text-royal text-sm bg-royal/10 px-3 py-1 rounded-full border border-royal/20">0</span>
            </h2>
            <button onclick="toggleWishlist()" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center hover:bg-royal hover:text-black transition-all duration-300 border border-white/10">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="wishlist-items" class="p-6 space-y-4 min-h-[300px]">
            <div class="text-center text-gray-500 py-16">
                <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/5 flex items-center justify-center">
                    <i class="fas fa-heart text-4xl opacity-20"></i>
                </div>
                <p class="text-lg mb-3 font-medium">Your wishlist is empty</p>
                <button onclick="toggleWishlist(); document.getElementById('products').scrollIntoView({behavior: 'smooth'})" class="text-royal hover:text-royal-light transition-colors font-medium text-sm">Discover Products</button>
            </div>
        </div>
    </div>

    <!-- Modern Cart Sidebar -->
    <div id="cart-overlay" class="fixed inset-0 bg-black/60 z-50 hidden backdrop-blur-sm transition-opacity duration-300" onclick="toggleCart()"></div>
    <div id="cart-sidebar" class="fixed right-0 top-0 h-full w-full sm:w-[420px] z-50 cart-sidebar overflow-y-auto border-l border-royal/10 shadow-2xl">
        <div class="p-6 border-b border-white/5 flex justify-between items-center sticky top-0 bg-[#111]/95 backdrop-blur-xl z-10">
            <h2 class="font-display text-2xl font-bold flex items-center gap-3">
                <i class="fas fa-mosque text-royal"></i>
                Your Cart 
                <span id="cart-total-items" class="text-royal text-sm bg-royal/10 px-3 py-1 rounded-full border border-royal/20">0</span>
            </h2>
            <button onclick="toggleCart()" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center hover:bg-royal hover:text-black transition-all duration-300 border border-white/10">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="cart-items" class="p-6 space-y-4 min-h-[300px]">
            <div class="text-center text-gray-500 py-16">
                <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/5 flex items-center justify-center">
                    <i class="fas fa-mosque text-4xl opacity-20"></i>
                </div>
                <p class="text-lg mb-3 font-medium">Your cart is empty</p>
                <button onclick="toggleCart(); document.getElementById('products').scrollIntoView({behavior: 'smooth'})" class="text-royal hover:text-royal-light transition-colors font-medium text-sm">Start Shopping</button>
            </div>
        </div>

        <div class="p-6 border-t border-white/5 sticky bottom-0 bg-[#111]/95 backdrop-blur-xl">
            <div class="space-y-3 mb-6">
                <div class="flex justify-between text-gray-400 text-sm">
                    <span>Subtotal</span>
                    <span id="cart-subtotal" class="font-medium tabular-nums">$0.00</span>
                </div>
                <div class="flex justify-between text-gray-400 text-sm">
                    <span>Shipping</span>
                    <span class="text-royal font-medium">Free</span>
                </div>
                <div class="flex justify-between text-gray-400 text-sm">
                    <span>Tax (8%)</span>
                    <span id="cart-tax" class="font-medium tabular-nums">$0.00</span>
                </div>
                <div class="flex justify-between text-xl font-bold border-t border-white/10 pt-3 mt-3">
                    <span>Total</span>
                    <span id="cart-total" class="text-royal tabular-nums">$0.00</span>
                </div>
            </div>
            
            <button onclick="checkoutWhatsApp()" class="btn-primary w-full bg-gradient-to-r from-royal to-royal-dark text-black font-bold py-4 rounded-full hover:from-royal-light hover:to-royal transition-all flex items-center justify-center gap-3 text-base shadow-lg shadow-royal/20 hover:shadow-royal/40 transform hover:scale-[1.02] mb-3">
                <i class="fab fa-whatsapp text-xl"></i>
                Checkout via WhatsApp
            </button>
            <button onclick="toggleCart()" class="w-full border border-white/10 text-gray-400 font-medium py-3.5 rounded-full hover:bg-white/5 hover:text-white transition-all text-sm">
                Continue Shopping
            </button>
        </div>
    </div>

    <!-- Modern Toast -->
    <div id="toast" class="toast">
        <i class="fas fa-mosque text-xl"></i>
        <span id="toast-message">Added to cart!</span>
    </div>

    <!-- TikTok Fullscreen Modal -->
    <div id="tiktok-modal" class="tiktok-modal" onclick="closeTikTokModal(event)">
        <button class="tiktok-modal-close" onclick="closeTikTokModal()" aria-label="Close video">
            <i class="fas fa-times"></i>
        </button>
        <div id="modal-video-container" class="w-full max-w-[400px] h-[70vh] sm:h-[720px] relative mx-4">
            <!-- Video injected here -->
        </div>
    </div>

    <!-- Modern Hero Section -->
    <section class="relative min-h-[90vh] flex items-center justify-center overflow-hidden pt-20 bg-gradient-to-b from-[#0f0f0f] to-[#0a0a0a]">
        <!-- Animated Background Elements -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-20 left-10 w-72 h-72 bg-royal/5 rounded-full blur-[100px] animate-pulse"></div>
            <div class="absolute bottom-20 right-10 w-96 h-96 bg-oud/20 rounded-full blur-[120px] animate-pulse" style="animation-delay: 2s;"></div>
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] border border-royal/5 rounded-full animate-[spin_30s_linear_infinite]"></div>
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] border border-islamic-green/5 rounded-full animate-[spin_25s_linear_infinite_reverse]"></div>
        </div>

        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <!-- Badge -->
            <div class="inline-flex items-center gap-2 bg-gradient-to-r from-royal/10 to-oud/10 border border-royal/20 px-5 py-2.5 rounded-full mb-8 hover:from-royal/20 hover:to-oud/20 transition-all duration-500 cursor-pointer group" onclick="document.getElementById('products').scrollIntoView({behavior: 'smooth'})">
                <i class="fas fa-star-and-crescent text-royal text-sm group-hover:rotate-12 transition-transform duration-300"></i>
                <span class="text-xs font-bold tracking-[0.2em] uppercase text-gradient">Authentic Islamic Lifestyle</span>
            </div>
            
            <!-- Main Title -->
            <h1 class="font-display text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-bold mb-6 leading-[1.1] tracking-tight">
                Elegance in <br>
                <span class="text-gradient inline-block mt-2">Modesty</span>
            </h1>
            
            <!-- Subtitle -->
            <p class="text-base sm:text-lg md:text-xl text-gray-400 max-w-2xl mx-auto mb-10 leading-relaxed font-light">
                Premium <span class="text-royal font-semibold">Official Formal Wear</span>, Halal fragrances, and Islamic essentials. 
                <span class="block mt-2 text-gray-500">Dress with dignity, scent with purity, live with faith.</span>
            </p>
            
            <!-- CTA Buttons -->
            <div class="flex flex-col sm:flex-row flex-wrap justify-center gap-4 px-4 mb-16">
                <button onclick="filterCategory('formal')" class="btn-primary px-8 py-4 bg-gradient-to-r from-royal to-royal-dark text-black font-bold rounded-full hover:scale-105 transition-transform flex items-center justify-center gap-3 shadow-xl shadow-royal/20 text-sm sm:text-base group">
                    <i class="fas fa-user-tie group-hover:rotate-12 transition-transform"></i> 
                    Formal Collection
                </button>
                <button onclick="showWhatsAppChat()" class="px-8 py-4 bg-white/5 text-white font-semibold rounded-full hover:bg-white/10 transition-all flex items-center justify-center gap-3 border border-white/10 hover:border-royal/30 text-sm sm:text-base backdrop-blur-sm">
                    <i class="fab fa-whatsapp text-royal text-xl"></i> 
                    Personal Stylist
                </button>
            </div>

            <!-- Modern Stats Grid -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 max-w-5xl mx-auto px-4">
                <div class="hero-stat text-center rounded-2xl p-5 cursor-pointer group">
                    <p class="font-display text-3xl sm:text-4xl font-bold text-royal group-hover:scale-110 transition-transform duration-300 inline-block">100%</p>
                    <p class="text-xs text-gray-500 mt-2 font-medium tracking-wide">Halal Certified</p>
                </div>
                <div class="hero-stat text-center rounded-2xl p-5 cursor-pointer group">
                    <p class="font-display text-3xl sm:text-4xl font-bold text-oud-light group-hover:scale-110 transition-transform duration-300 inline-block">50+</p>
                    <p class="text-xs text-gray-500 mt-2 font-medium tracking-wide">Premium Attars</p>
                </div>
                <div class="hero-stat text-center rounded-2xl p-5 cursor-pointer group">
                    <p class="font-display text-3xl sm:text-4xl font-bold text-islamic-green group-hover:scale-110 transition-transform duration-300 inline-block">30+</p>
                    <p class="text-xs text-gray-500 mt-2 font-medium tracking-wide">Formal Designs</p>
                </div>
                <div class="hero-stat text-center rounded-2xl p-5 cursor-pointer group">
                    <p class="font-display text-3xl sm:text-4xl font-bold text-white group-hover:text-royal transition-colors duration-300">24h</p>
                    <p class="text-xs text-gray-500 mt-2 font-medium tracking-wide">Dispatch</p>
                </div>
                <div class="hero-stat text-center rounded-2xl p-5 cursor-pointer group">
                    <p class="font-display text-3xl sm:text-4xl font-bold text-white group-hover:text-royal transition-colors duration-300">5</p>
                    <p class="text-xs text-gray-500 mt-2 font-medium tracking-wide">Categories</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Modern Features Bar -->
    <section class="py-8 bg-[#111] border-y border-white/5">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-5 gap-6 text-center">
                <div class="flex items-center justify-center gap-3 text-gray-400 group cursor-pointer hover:text-royal transition-colors duration-300">
                    <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-royal/10 transition-colors">
                        <i class="fas fa-user-tie text-xl text-royal"></i>
                    </div>
                    <div class="text-left hidden sm:block">
                        <p class="font-bold text-sm">Formal Wear</p>
                        <p class="text-xs text-gray-600">Premium Thobes</p>
                    </div>
                </div>
                <div class="flex items-center justify-center gap-3 text-gray-400 group cursor-pointer hover:text-royal transition-colors duration-300">
                    <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-royal/10 transition-colors">
                        <i class="fas fa-wine-bottle-slash text-xl text-royal"></i>
                    </div>
                    <div class="text-left hidden sm:block">
                        <p class="font-bold text-sm">100% Halal</p>
                        <p class="text-xs text-gray-600">Alcohol-Free</p>
                    </div>
                </div>
                <div class="flex items-center justify-center gap-3 text-gray-400 group cursor-pointer hover:text-royal transition-colors duration-300">
                    <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-royal/10 transition-colors">
                        <i class="fas fa-mosque text-xl text-royal"></i>
                    </div>
                    <div class="text-left hidden sm:block">
                        <p class="font-bold text-sm">Islamic Values</p>
                        <p class="text-xs text-gray-600">Authentic Products</p>
                    </div>
                </div>
                <div class="flex items-center justify-center gap-3 text-gray-400 group cursor-pointer hover:text-royal transition-colors duration-300">
                    <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-royal/10 transition-colors">
                        <i class="fas fa-shipping-fast text-xl text-royal"></i>
                    </div>
                    <div class="text-left hidden sm:block">
                        <p class="font-bold text-sm">Global Shipping</p>
                        <p class="text-xs text-gray-600">Orders $100+</p>
                    </div>
                </div>
                <div class="flex items-center justify-center gap-3 text-gray-400 group cursor-pointer hover:text-royal transition-colors duration-300">
                    <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-royal/10 transition-colors">
                        <i class="fab fa-whatsapp text-xl text-royal"></i>
                    </div>
                    <div class="text-left hidden sm:block">
                        <p class="font-bold text-sm">Islamic Support</p>
                        <p class="text-xs text-gray-600">Scholar Verified</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modern Category Pills -->
    <section class="py-6 bg-[#0a0a0a] border-b border-white/5 sticky top-16 sm:top-20 z-40 transition-all duration-300" id="category-nav">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex overflow-x-auto gap-3 pb-2 scrollbar-hide">
                <button onclick="filterCategory('all')" class="category-pill active whitespace-nowrap px-6 py-3 rounded-full text-sm font-bold transition-all" data-category="all">All Items</button>
                <button onclick="filterCategory('formal')" class="category-pill whitespace-nowrap px-6 py-3 rounded-full text-sm font-bold transition-all text-gray-400" data-category="formal"> Formal Wear</button>
                <button onclick="filterCategory('perfumes')" class="category-pill whitespace-nowrap px-6 py-3 rounded-full text-sm font-bold transition-all text-gray-400" data-category="perfumes"> Perfumes</button>
                <button onclick="filterCategory('shoes')" class="category-pill whitespace-nowrap px-6 py-3 rounded-full text-sm font-bold transition-all text-gray-400" data-category="shoes"> Shoes</button>
                <button onclick="filterCategory('attars')" class="category-pill whitespace-nowrap px-6 py-3 rounded-full text-sm font-bold transition-all text-gray-400" data-category="attars"> Attars & Oils</button>
                <button onclick="filterCategory('essentials')" class="category-pill whitespace-nowrap px-6 py-3 rounded-full text-sm font-bold transition-all text-gray-400" data-category="essentials"> Essentials</button>
            </div>
        </div>
    </section>

    <!-- Modern Products Section -->
    <section id="products" class="py-16 sm:py-24 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto min-h-screen">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4 reveal">
            <div>
                <h2 class="font-display text-3xl sm:text-4xl font-bold flex items-center gap-3 mb-2">
                    <i class="fas fa-star-and-crescent text-royal text-2xl"></i>
                    <span id="category-title">All Islamic Collection</span>
                </h2>
                <p class="text-gray-500 flex items-center gap-2 text-sm">
                    <i class="fas fa-check-circle text-royal text-xs"></i>
                    <span id="category-count">Showing all halal-certified items</span>
                </p>
            </div>
            <div class="flex items-center gap-4 w-full md:w-auto">
                <div class="flex items-center gap-2 text-sm text-gray-400 bg-[#111] px-4 py-2.5 rounded-full border border-white/5 flex-1 md:flex-none">
                    <i class="fas fa-sort text-royal"></i>
                    <select onchange="sortProducts(this.value)" class="bg-transparent border-none focus:outline-none text-white cursor-pointer w-full text-sm">
                        <option value="newest">Newest First</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="popular">Most Popular</option>
                    </select>
                </div>
                <div class="flex gap-2">
                    <button onclick="setView('grid')" class="view-btn active w-10 h-10 rounded-lg flex items-center justify-center transition-all" id="grid-view-btn">
                        <i class="fas fa-th-large"></i>
                    </button>
                    <button onclick="setView('list')" class="view-btn w-10 h-10 rounded-lg flex items-center justify-center text-gray-400 hover:text-royal transition-all" id="list-view-btn">
                        <i class="fas fa-list"></i>
                    </button>
                </div>
            </div>
        </div>

        <div id="products-grid" class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6">
            <!-- Injected by JS -->
        </div>

        <div id="no-results" class="hidden text-center py-20">
            <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/5 flex items-center justify-center">
                <i class="fas fa-search text-3xl text-gray-600"></i>
            </div>
            <p class="text-xl text-gray-400 mb-4">No products found</p>
            <button onclick="filterCategory('all'); document.getElementById('search-input').value=''" class="text-royal hover:text-royal-light transition-colors font-medium text-sm">Clear all filters</button>
        </div>

        <div class="mt-16 text-center reveal">
            <button onclick="loadMoreProducts()" id="load-more-btn" class="px-8 py-4 bg-[#111] border border-white/10 rounded-full text-sm font-bold hover:border-royal/30 hover:text-royal transition-all flex items-center gap-3 mx-auto text-gray-400 hover:bg-royal/5 group">
                <i class="fas fa-spinner group-hover:animate-spin"></i> 
                Load More Products
            </button>
        </div>
    </section>

    <!-- Modern Size Guide -->
    <section class="py-20 sm:py-28 bg-[#111] border-y border-white/5">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center reveal">
            <div class="inline-flex items-center gap-2 mb-6">
                <i class="fas fa-ruler text-royal text-xl"></i>
                <span class="text-xs font-bold tracking-[0.2em] uppercase text-royal">Size Guide</span>
            </div>
            <h2 class="font-display text-3xl sm:text-4xl font-bold mb-3">Clothing & Footwear Size Guide</h2>
            <p class="text-gray-500 mb-10 text-sm sm:text-base max-w-xl mx-auto">Find your perfect fit for our formal wear and footwear collection. All measurements are in inches.</p>
            
            <div class="glass rounded-2xl p-6 sm:p-10 gold-border overflow-x-auto">
                <table class="w-full text-left text-sm">
                    <thead>
                        <tr class="border-b border-royal/20">
                            <th class="pb-4 font-bold text-royal text-sm uppercase tracking-wider">Size</th>
                            <th class="pb-4 font-bold text-gray-400 text-sm uppercase tracking-wider">Chest (in)</th>
                            <th class="pb-4 font-bold text-gray-400 text-sm uppercase tracking-wider">Length (in)</th>
                            <th class="pb-4 font-bold text-gray-400 text-sm uppercase tracking-wider">US Shoe</th>
                            <th class="pb-4 font-bold text-gray-400 text-sm uppercase tracking-wider hidden sm:table-cell">Height</th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-400">
                        <tr class="border-b border-white/5 hover:bg-white/5 transition-colors"><td class="py-4 font-bold text-white">S</td><td>36-38</td><td>52</td><td>7-8</td><td class="hidden sm:table-cell">5'4"-5'6"</td></tr>
                        <tr class="border-b border-white/5 hover:bg-white/5 transition-colors"><td class="py-4 font-bold text-white">M</td><td>38-40</td><td>54</td><td>8-9</td><td class="hidden sm:table-cell">5'6"-5'8"</td></tr>
                        <tr class="border-b border-white/5 hover:bg-white/5 transition-colors"><td class="py-4 font-bold text-white">L</td><td>40-42</td><td>56</td><td>9-10</td><td class="hidden sm:table-cell">5'8"-5'10"</td></tr>
                        <tr class="border-b border-white/5 hover:bg-white/5 transition-colors"><td class="py-4 font-bold text-white">XL</td><td>42-44</td><td>58</td><td>10-11</td><td class="hidden sm:table-cell">5'10"-6'0"</td></tr>
                        <tr class="hover:bg-white/5 transition-colors"><td class="py-4 font-bold text-white">XXL</td><td>44-46</td><td>60</td><td>11-12</td><td class="hidden sm:table-cell">6'0"+</td></tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-gray-600 mt-6 italic">* Thobes are designed for a relaxed, modest fit. For a tailored look, size down. Shoes run true to size.</p>
        </div>
    </section>

    <!-- Modern WhatsApp Float -->
    <div class="whatsapp-float">
        <button onclick="showWhatsAppChat()" class="w-14 h-14 sm:w-16 sm:h-16 bg-gradient-to-r from-royal to-royal-dark rounded-full flex items-center justify-center text-black text-2xl sm:text-3xl shadow-2xl hover:scale-110 transition-transform border-4 border-[#0a0a0a] group relative overflow-hidden">
            <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
            <i class="fab fa-whatsapp relative z-10 group-hover:rotate-12 transition-transform duration-300"></i>
        </button>
    </div>

    <!-- Modern Quick View Modal -->
    <div id="quick-view-modal" class="fixed inset-0 bg-black/80 z-[60] modal flex items-center justify-center p-0 sm:p-4 backdrop-blur-md">
        <div class="bg-[#111] rounded-none sm:rounded-3xl max-w-5xl w-full max-h-[100vh] sm:max-h-[90vh] overflow-y-auto border border-white/10 shadow-2xl relative">
            <button onclick="closeQuickView()" class="absolute top-4 right-4 z-10 w-12 h-12 rounded-full bg-white/5 flex items-center justify-center hover:bg-royal hover:text-black transition-all duration-300 text-xl border border-white/10">
                <i class="fas fa-times"></i>
            </button>
            <div id="modal-content" class="grid md:grid-cols-2 gap-0">
                <!-- Injected by JS -->
            </div>
        </div>
    </div>

    <!-- Modern Footer -->
    <footer class="bg-[#0a0a0a] border-t border-white/5 pt-16 sm:pt-20 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-10 sm:gap-12 mb-16">
                <!-- Brand Column -->
                <div class="lg:col-span-2">
                    <span class="font-display text-3xl font-bold tracking-wider text-white mb-6 block flex items-center gap-3">
                        <i class="fas fa-mosque text-royal crown-icon text-2xl"></i>
                        ROYAL
                        <span class="text-sm font-normal text-gray-600 ml-2 tracking-normal">ISLAMIC</span>
                    </span>
                    <p class="text-gray-500 text-sm leading-relaxed mb-6 max-w-sm">
                        Premium <span class="text-royal font-semibold">Official Formal Wear</span>, Halal fragrances, and Islamic lifestyle products. 
                        Dress with dignity, scent with purity, live with faith. 
                        <span class="font-arabic text-royal block mt-2 text-lg">   </span>
                    </p>
                    <div class="flex space-x-3">
                        <a href="#" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:bg-royal hover:text-black transition-all duration-300 border border-white/10 hover:border-royal">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:bg-royal hover:text-black transition-all duration-300 border border-white/10 hover:border-royal">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:bg-royal hover:text-black transition-all duration-300 border border-white/10 hover:border-royal">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>

                <!-- Shop Links -->
                <div>
                    <h4 class="font-display font-bold text-lg mb-6 text-royal">Shop</h4>
                    <ul class="space-y-3 text-sm text-gray-500">
                        <li><a href="#" onclick="filterCategory('formal')" class="footer-link hover:text-royal transition-colors flex items-center gap-3"><i class="fas fa-user-tie w-4 text-center text-xs"></i> Formal Wear</a></li>
                        <li><a href="#" onclick="filterCategory('perfumes')" class="footer-link hover:text-royal transition-colors flex items-center gap-3"><i class="fas fa-spray-can w-4 text-center text-xs"></i> Perfumes</a></li>
                        <li><a href="#" onclick="filterCategory('shoes')" class="footer-link hover:text-royal transition-colors flex items-center gap-3"><i class="fas fa-shoe-prints w-4 text-center text-xs"></i> Footwear</a></li>
                        <li><a href="#" onclick="filterCategory('attars')" class="footer-link hover:text-royal transition-colors flex items-center gap-3"><i class="fas fa-oil-can w-4 text-center text-xs"></i> Attars & Oils</a></li>
                        <li><a href="#" onclick="filterCategory('essentials')" class="footer-link hover:text-royal transition-colors flex items-center gap-3"><i class="fas fa-pray w-4 text-center text-xs"></i> Essentials</a></li>
                    </ul>
                </div>

                <!-- Help Links -->
                <div>
                    <h4 class="font-display font-bold text-lg mb-6 text-royal">Help</h4>
                    <ul class="space-y-3 text-sm text-gray-500">
                        <li><a href="#" class="footer-link hover:text-royal transition-colors">Size Guide</a></li>
                        <li><a href="#" class="footer-link hover:text-royal transition-colors">Halal Certification</a></li>
                        <li><a href="#" class="footer-link hover:text-royal transition-colors">Shipping Info</a></li>
                        <li><a href="#" class="footer-link hover:text-royal transition-colors">Returns & Exchanges</a></li>
                        <li><a href="#" class="footer-link hover:text-royal transition-colors">FAQ</a></li>
                    </ul>
                </div>

                <!-- Contact -->
                <div>
                    <h4 class="font-display font-bold text-lg mb-6 text-royal">Contact</h4>
                    <ul class="space-y-4 text-sm text-gray-500">
                        <li class="flex items-center gap-3 hover:text-royal transition-colors cursor-pointer group" onclick="showWhatsAppChat()">
                            <div class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-royal/10 transition-colors">
                                <i class="fab fa-whatsapp text-royal"></i>
                            </div>
                            <span>+254704918499</span>
                        </li>
                        <li class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center">
                                <i class="fas fa-envelope text-royal"></i>
                            </div>
                            <span>salam@royalislamic.com</span>
                        </li>
                        <li class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center">
                                <i class="fas fa-mosque text-royal"></i>
                            </div>
                            <span>24/7 Islamic Support</span>
                        </li>
                        <li class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center">
                                <i class="fas fa-map-marker-alt text-royal"></i>
                            </div>
                            <span>Nairobi, Kenya</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Bottom Bar -->
            <div class="border-t border-white/5 pt-8 flex flex-col sm:flex-row justify-between items-center gap-4">
                <p class="text-xs text-gray-600 text-center sm:text-left"> 2024 ROYAL Islamic. All rights reserved. <span class="font-arabic text-royal mr-2">  </span></p>
                <div class="flex items-center gap-4 text-xl text-gray-700">
                    <i class="fas fa-certificate text-royal hover:scale-110 transition-transform cursor-pointer" title="Halal Certified"></i>
                    <i class="fab fa-cc-visa hover:text-royal transition-colors cursor-pointer"></i>
                    <i class="fab fa-cc-mastercard hover:text-royal transition-colors cursor-pointer"></i>
                    <i class="fab fa-cc-paypal hover:text-royal transition-colors cursor-pointer"></i>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Modern Product Database
        const products = [
            // FORMAL WEAR CATEGORY
            {
                id: 101,
                name: "Royal White Thobe - Premium",
                brand: "ROYAL",
                price: 38,
                originalPrice: 45,
                category: "formal",
                subcategory: "Thobes",
                image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR3Bv0lfRqyjIZthmx3yquScoQFHV9K4LIetg&s",
                tiktokVideoId: "7612379510498938113",
                tiktokUsername: "royalislamic",
                badge: "BESTSELLER",
                description: "Premium thobes, bishts with gold-thread embroidery, and executive jubbas worthy of palace gates..",
                sizes: ["S", "M", "L", "XL", "XXL"],
                colors: ["Black", "Dark Brown", "Navy", "Cream", "Light Grey"],  
                stock: 25,
                popularity: 98,
                videoDuration: "0:20",
                halalCertified: true,
                fabric: "Premium Cotton Blend"
            },
            {
                id: 102,
                name: "Official Black Bisht - Gold Trim",
                brand: "ROYAL",
                price: 350,
                category: "formal",
                subcategory: "Bishts",
                image: "https://images.unsplash.com/photo-1593032465175-481ac7f401a0?w=800&q=80",
                tiktokVideoId: "7612046437991370002",
                tiktokUsername: "royalislamic",
                badge: "LUXURY",
                description: "Elegant black bisht with hand-stitched gold trim. Worn over thobe for official events, weddings, and special gatherings. Lightweight wool blend.",
                sizes: ["M", "L", "XL", "XXL"],
                colors: ["Black", "Dark Brown", "Navy"],
                stock: 12,
                popularity: 96,
                videoDuration: "0:25",
                halalCertified: true,
                fabric: "Wool Blend"
            },
            {
                id: 103,
                name: "Cream Jubba - Executive",
                brand: "ROYAL",
                price: 220,
                originalPrice: 280,
                category: "formal",
                subcategory: "Jubbas",
                image: "https://images.unsplash.com/photo-1552374196-1ab2a1c593e8?w=800&q=80",
                tiktokVideoId: "7612046437991370003",
                tiktokUsername: "royalislamic",
                badge: "SALE",
                description: "Sophisticated cream jubba with mandarin collar. Ideal for business meetings and semi-formal Islamic events. Wrinkle-resistant fabric.",
                sizes: ["S", "M", "L", "XL"],
                colors: ["Cream", "Beige", "Light Grey"],
                stock: 18,
                popularity: 94,
                videoDuration: "0:18",
                halalCertified: true,
                fabric: "Polyester Blend"
            },
            {
                id: 104,
                name: "Royal Blue Thobe - Official",
                brand: "ROYAL",
                price: 195,
                category: "formal",
                subcategory: "Thobes",
                image: "https://images.unsplash.com/photo-1593032465175-481ac7f401a0?w=800&q=80",
                tiktokVideoId: "7612046437991370004",
                tiktokUsername: "royalislamic",
                badge: "NEW",
                description: "Stunning royal blue thobe for distinguished occasions. Features concealed pockets and premium stitching. Modern cut with traditional elegance.",
                sizes: ["M", "L", "XL", "XXL"],
                colors: ["Royal Blue", "Navy", "Charcoal"],
                stock: 15,
                popularity: 92,
                videoDuration: "0:22",
                halalCertified: true,
                fabric: "Premium Cotton"
            },
            {
                id: 105,
                name: "Gold Embroidered Thobe - Limited",
                brand: "ROYAL",
                price: 450,
                category: "formal",
                subcategory: "Luxury Thobes",
                image: "https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=800&q=80",
                tiktokVideoId: "7612046437991370005",
                tiktokUsername: "royalislamic",
                badge: "LIMITED",
                description: "Exclusive thobe with intricate gold hand-embroidery. Limited edition of 50 pieces. Perfect for weddings and Eid celebrations. Includes luxury box.",
                sizes: ["M", "L", "XL"],
                colors: ["White", "Black"],
                stock: 5,
                popularity: 99,
                videoDuration: "0:30",
                halalCertified: true,
                fabric: "Egyptian Cotton"
            },
            {
                id: 106,
                name: "Charcoal Formal Kurta",
                brand: "ROYAL",
                price: 145,
                category: "formal",
                subcategory: "Kurtas",
                image: "https://images.unsplash.com/photo-1552374196-1ab2a1c593e8?w=800&q=80",
                tiktokVideoId: "7612046437991370006",
                tiktokUsername: "royalislamic",
                badge: null,
                description: "Modern charcoal kurta with clean lines. Versatile for both formal and smart-casual occasions. Breathable fabric with modest tailoring.",
                sizes: ["S", "M", "L", "XL", "XXL"],
                colors: ["Charcoal", "Black", "Navy"],
                stock: 30,
                popularity: 89,
                videoDuration: "0:15",
                halalCertified: true,
                fabric: "Cotton Linen"
            },
            {
                id: 107,
                name: "White Shalwar Kameez - Premium",
                brand: "ROYAL",
                price: 165,
                category: "formal",
                subcategory: "Shalwar Kameez",
                image: "https://images.unsplash.com/photo-1593032465175-481ac7f401a0?w=800&q=80",
                tiktokVideoId: "7612046437991370007",
                tiktokUsername: "royalislamic",
                badge: "POPULAR",
                description: "Classic white shalwar kameez set with detailed stitching. Traditional South Asian formal wear. Includes matching shalwar and kurta.",
                sizes: ["S", "M", "L", "XL", "XXL"],
                colors: ["White", "Off-White"],
                stock: 22,
                popularity: 93,
                videoDuration: "0:20",
                halalCertified: true,
                fabric: "Pure Cotton"
            },
            {
                id: 108,
                name: "Burgundy Official Thobe",
                brand: "ROYAL",
                price: 210,
                category: "formal",
                subcategory: "Thobes",
                image: "https://images.unsplash.com/photo-1594938298603-c8148c4dae35?w=800&q=80",
                tiktokVideoId: "7612046437991370008",
                tiktokUsername: "royalislamic",
                badge: "NEW",
                description: "Rich burgundy thobe for those who seek distinction. Deep color with subtle sheen. Perfect for evening events and winter gatherings.",
                sizes: ["M", "L", "XL", "XXL"],
                colors: ["Burgundy", "Maroon"],
                stock: 14,
                popularity: 91,
                videoDuration: "0:18",
                halalCertified: true,
                fabric: "Premium Blend"
            },

            // PERFUMES CATEGORY
            {
                id: 1,
                name: "Royal Oud Al-Misk",
                brand: "ROYAL",
                price: 120,
                originalPrice: 150,
                category: "perfumes",
                subcategory: "Luxury Sprays",
                image: "https://images.unsplash.com/photo-1594035910387-fea47794261f?w=800&q=80",
                tiktokVideoId: "7612046437991370004",
                tiktokUsername: "royalislamic",
                badge: "BESTSELLER",
                description: "Premium alcohol-free EDP with rich oud and musk notes. Long-lasting fragrance perfect for prayers and special occasions.",
                sizes: ["50ml", "100ml"],
                concentrations: ["Eau de Parfum", "Intense"],
                stock: 25,
                popularity: 98,
                videoDuration: "0:15",
                halalCertified: true
            },
            {
                id: 2,
                name: "Amber Sultan Attar",
                brand: "ROYAL",
                price: 85,
                category: "perfumes",
                subcategory: "Attar Spray",
                image: "https://images.unsplash.com/photo-1541643600914-78b084683601?w=800&q=80",
                tiktokVideoId: "6830059644233223429",
                tiktokUsername: "royalislamic",
                badge: "NEW",
                description: "Warm amber blended with royal oud. Traditional Middle Eastern scent in modern spray format. 100% alcohol-free.",
                sizes: ["30ml", "60ml"],
                concentrations: ["Pure Attar", "Spray"],
                stock: 18,
                popularity: 95,
                videoDuration: "0:12",
                halalCertified: true
            },
            {
                id: 3,
                name: "Madinah Rose EDP",
                brand: "ROYAL",
                price: 95,
                originalPrice: 120,
                category: "perfumes",
                subcategory: "Floral Collection",
                image: "https://images.unsplash.com/photo-1590736969955-71cc94901144?w=800&q=80",
                tiktokVideoId: "6901234567890123456",
                tiktokUsername: "royalislamic",
                badge: "SALE",
                description: "Delicate Taif rose blended with saffron and sandalwood. Inspired by the gardens of Madinah. Perfect for daily wear.",
                sizes: ["50ml"],
                concentrations: ["Eau de Parfum"],
                stock: 12,
                popularity: 92,
                videoDuration: "0:18",
                halalCertified: true
            },
            {
                id: 4,
                name: "Black Oud Collection",
                brand: "ROYAL",
                price: 250,
                category: "perfumes",
                subcategory: "Ultra-Luxury",
                image: "https://images.unsplash.com/photo-1587017539504-67cfbddac569?w=800&q=80",
                tiktokVideoId: "6912345678901234567",
                tiktokUsername: "royalislamic",
                badge: "LIMITED",
                description: "Aged Cambodian oud oil in crystal bottle. Collector's edition with certificate of authenticity. Only 100 bottles produced.",
                sizes: ["12ml", "30ml"],
                concentrations: ["Pure Oud Oil", "Spray"],
                stock: 3,
                popularity: 99,
                videoDuration: "0:25",
                halalCertified: true
            },

            // SHOES CATEGORY
            {
                id: 5,
                name: "Royal Prayer Slippers",
                brand: "ROYAL",
                price: 45,
                category: "shoes",
                subcategory: "Prayer Shoes",
                image: "https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=800&q=80",
                tiktokVideoId: "6923456789012345678",
                tiktokUsername: "royalislamic",
                badge: "BESTSELLER",
                description: "Soft leather slippers designed for mosque wear. Easy slip-on style with cushioned sole for extended prayers.",
                sizes: ["7", "8", "9", "10", "11", "12"],
                colors: ["Black", "Brown", "Tan"],
                stock: 30,
                popularity: 94,
                videoDuration: "0:10",
                halalCertified: true
            },
            {
                id: 6,
                name: "Formal Islamic Loafers",
                brand: "ROYAL",
                price: 120,
                originalPrice: 160,
                category: "shoes",
                subcategory: "Formal Shoes",
                image: "https://images.unsplash.com/photo-1614252235316-8c857d38b5f4?w=800&q=80",
                tiktokVideoId: "7101234567890123456",
                tiktokUsername: "royalislamic",
                badge: null,
                description: "Premium leather formal shoes suitable for Jumu'ah and weddings. Modest design with no ostentatious branding.",
                sizes: ["7", "8", "9", "10", "11"],
                colors: ["Black", "Dark Brown"],
                stock: 15,
                popularity: 88,
                videoDuration: "0:15",
                halalCertified: true
            },
            {
                id: 7,
                name: "Arabian Sandals - Premium",
                brand: "ROYAL",
                price: 75,
                category: "shoes",
                subcategory: "Arabian Style",
                image: "https://images.unsplash.com/photo-1603487742131-4160ec999306?w=800&q=80",
                tiktokVideoId: "7112345678901234567",
                tiktokUsername: "royalislamic",
                badge: "NEW",
                description: "Traditional Arabic sandals with modern comfort. Genuine leather straps with cushioned footbed. Perfect for hot climates.",
                sizes: ["7", "8", "9", "10", "11", "12"],
                colors: ["Brown", "Tan", "Black"],
                stock: 20,
                popularity: 91,
                videoDuration: "0:12",
                halalCertified: true
            },
            {
                id: 8,
                name: "Royal Collection Oxfords",
                brand: "ROYAL",
                price: 180,
                category: "shoes",
                subcategory: "Royal Collection",
                image: "https://images.unsplash.com/photo-1614252369475-531eba835eb1?w=800&q=80",
                tiktokVideoId: "7123456789012345678",
                tiktokUsername: "royalislamic",
                badge: "LIMITED",
                description: "Handcrafted oxford shoes with gold accents. Luxury collection for special occasions. Each pair numbered and boxed.",
                sizes: ["8", "9", "10", "11"],
                colors: ["Black Gold", "Brown Gold"],
                stock: 5,
                popularity: 96,
                videoDuration: "0:20",
                halalCertified: true
            },

            // ATTARS & OILS CATEGORY
            {
                id: 9,
                name: "Pure Oud Al-Hind",
                brand: "ROYAL",
                price: 200,
                category: "attars",
                subcategory: "Premium Oud Attars",
                image: "https://images.unsplash.com/photo-1598440947619-2c35fc9aa908?w=800&q=80",
                tiktokVideoId: "7134567890123456789",
                tiktokUsername: "royalislamic",
                badge: "BESTSELLER",
                description: "Pure Indian oud oil, aged 10 years. Rich, woody scent with smoky undertones. Roll-on applicator for precise application.",
                sizes: ["6ml", "12ml"],
                concentrations: ["Pure Oil", "Roll-On"],
                stock: 12,
                popularity: 97,
                videoDuration: "0:18",
                halalCertified: true
            },
            {
                id: 10,
                name: "Musk Tahara Roll-On",
                brand: "ROYAL",
                price: 25,
                originalPrice: 35,
                category: "attars",
                subcategory: "Perfume Oils",
                image: "https://images.unsplash.com/photo-1590736969955-71cc94901144?w=800&q=80",
                tiktokVideoId: "7145678901234567890",
                tiktokUsername: "royalislamic",
                badge: "SALE",
                description: "White musk attar - clean, pure scent perfect for daily use after wudu. Alcohol-free and long-lasting.",
                sizes: ["10ml"],
                concentrations: ["Roll-On"],
                stock: 50,
                popularity: 93,
                videoDuration: "0:10",
                halalCertified: true
            },
            {
                id: 11,
                name: "Sandalwood & Oud Blend",
                brand: "ROYAL",
                price: 65,
                category: "attars",
                subcategory: "Attars & Oils",
                image: "https://images.unsplash.com/photo-1594035910387-fea47794261f?w=800&q=80",
                tiktokVideoId: "7156789012345678901",
                tiktokUsername: "royalislamic",
                badge: null,
                description: "Smooth sandalwood balanced with premium oud. Perfect for meditation and prayer times. Traditional oil format.",
                sizes: ["12ml"],
                concentrations: ["Oil"],
                stock: 22,
                popularity: 89,
                videoDuration: "0:15",
                halalCertified: true
            },
            {
                id: 12,
                name: "Collector's Oud Set",
                brand: "ROYAL",
                price: 450,
                category: "attars",
                subcategory: "Ultra-Luxury",
                image: "https://images.unsplash.com/photo-1587017539504-67cfbddac569?w=800&q=80",
                tiktokVideoId: "7167890123456789012",
                tiktokUsername: "royalislamic",
                badge: "LIMITED",
                description: "Set of 3 rare oud oils: Cambodian, Indian, and Malaysian. Wooden presentation box with certificates.",
                sizes: ["3x6ml"],
                concentrations: ["Pure Oil"],
                stock: 2,
                popularity: 99,
                videoDuration: "0:30",
                halalCertified: true
            },

            // ESSENTIALS CATEGORY
            {
                id: 13,
                name: "Premium Prayer Rug",
                brand: "ROYAL",
                price: 85,
                category: "essentials",
                subcategory: "Spiritual & Prayer",
                image: "https://images.unsplash.com/photo-1584551246679-0daf3d275d0f?w=800&q=80",
                tiktokVideoId: "7178901234567890123",
                tiktokUsername: "royalislamic",
                badge: "BESTSELLER",
                description: "Luxury padded prayer rug with qibla compass. Soft velvet with Islamic geometric patterns. Includes carrying bag.",
                sizes: ["Standard", "Large"],
                colors: ["Green", "Blue", "Red"],
                stock: 35,
                popularity: 95,
                videoDuration: "0:12",
                halalCertified: true
            },
            {
                id: 14,
                name: "Tasbih - Crystal Beads",
                brand: "ROYAL",
                price: 35,
                category: "essentials",
                subcategory: "Spiritual & Prayer",
                image: "https://images.unsplash.com/photo-1583089892943-e02e5b017b6a?w=800&q=80",
                tiktokVideoId: "7189012345678901234",
                tiktokUsername: "royalislamic",
                badge: null,
                description: "99 crystal prayer beads with gold accents. Smooth glide for dhikr. Includes velvet pouch.",
                sizes: ["8mm", "10mm"],
                colors: ["Clear", "Amber", "Green"],
                stock: 28,
                popularity: 87,
                videoDuration: "0:10",
                halalCertified: true
            },
            {
                id: 15,
                name: "Ihram Set - Premium",
                brand: "ROYAL",
                price: 120,
                category: "essentials",
                subcategory: "Travel & Hajj",
                image: "https://images.unsplash.com/photo-1564769625905-50e93615e769?w=800&q=80",
                tiktokVideoId: "7190123456789012345",
                tiktokUsername: "royalislamic",
                badge: "NEW",
                description: "Complete ihram set for Umrah/Hajj. High-quality microfiber towels, belt, and travel bag. Lightweight and absorbent.",
                sizes: ["One Size"],
                colors: ["White"],
                stock: 40,
                popularity: 92,
                videoDuration: "0:20",
                halalCertified: true
            },
            {
                id: 16,
                name: "Islamic Gift Box",
                brand: "ROYAL",
                price: 150,
                category: "essentials",
                subcategory: "Gift Sets",
                image: "https://images.unsplash.com/photo-1512909006721-3d6018887383?w=800&q=80",
                tiktokVideoId: "7201234567890123456",
                tiktokUsername: "royalislamic",
                badge: "POPULAR",
                description: "Curated gift set: attar, prayer rug, tasbih, and miswak. Beautifully packaged for Eid or special occasions.",
                sizes: ["Standard"],
                colors: ["Gold Box"],
                stock: 15,
                popularity: 94,
                videoDuration: "0:25",
                halalCertified: true
            },
            {
                id: 17,
                name: "Kufi Cap - Premium",
                brand: "ROYAL",
                price: 30,
                category: "essentials",
                subcategory: "Headwear",
                image: "https://images.unsplash.com/photo-1583089892943-e02e5b017b6a?w=800&q=80",
                tiktokVideoId: "7212345678901234567",
                tiktokUsername: "royalislamic",
                badge: null,
                description: "Hand-stitched kufi cap in breathable cotton. Traditional designs suitable for daily prayer and Jumu'ah.",
                sizes: ["S", "M", "L", "XL"],
                colors: ["White", "Black", "Navy"],
                stock: 45,
                popularity: 86,
                videoDuration: "0:08",
                halalCertified: true
            },
            {
                id: 18,
                name: "Miswak & Holder Set",
                brand: "ROYAL",
                price: 20,
                category: "essentials",
                subcategory: "Grooming",
                image: "https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?w=800&q=80",
                tiktokVideoId: "7223456789012345678",
                tiktokUsername: "royalislamic",
                badge: null,
                description: "Natural miswak sticks with protective case. Sunnah dental care. Includes 3 fresh sticks and holder.",
                sizes: ["One Size"],
                colors: ["Natural"],
                stock: 60,
                popularity: 88,
                videoDuration: "0:10",
                halalCertified: true
            }
        ];

        let cart = [];
        let wishlist = [];
        let currentCategory = 'all';
        let currentSort = 'newest';
        let currentView = 'grid';
        let selectedColors = {};
        let selectedConcentrations = {};
        let loadedVideos = new Set();
        let videoIntersectionObserver = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initVideoIntersectionObserver();
            renderProducts();
            initScrollReveal();
            updateCategoryTitle();
            initStickyNav();
            loadFromLocalStorage();
        });

        function initVideoIntersectionObserver() {
            const options = { root: null, rootMargin: '100px', threshold: 0.1 };
            videoIntersectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('in-viewport');
                    }
                });
            }, options);
        }

        function loadFromLocalStorage() {
            const savedCart = localStorage.getItem('royalCart');
            const savedWishlist = localStorage.getItem('royalWishlist');
            if (savedCart) { cart = JSON.parse(savedCart); updateCartUI(); }
            if (savedWishlist) { wishlist = JSON.parse(savedWishlist); updateWishlistUI(); }
        }

        function saveToLocalStorage() {
            localStorage.setItem('royalCart', JSON.stringify(cart));
            localStorage.setItem('royalWishlist', JSON.stringify(wishlist));
        }

        function getTikTokEmbedUrl(videoId, username, autoplay = false) {
            const params = new URLSearchParams({ rel: '0', description: '1', autoplay: autoplay ? '1' : '0', loop: '1', music_info: '1', language: 'en' });
            return `https://www.tiktok.com/player/v1/${videoId}?${params.toString()}`;
        }

        function renderProducts(filter = 'all', searchTerm = '') {
            const grid = document.getElementById('products-grid');
            const noResults = document.getElementById('no-results');
            let filtered = products;

            if (filter !== 'all') filtered = filtered.filter(p => p.category === filter);
            if (searchTerm) filtered = filtered.filter(p => p.name.toLowerCase().includes(searchTerm.toLowerCase()) || p.brand.toLowerCase().includes(searchTerm.toLowerCase()) || p.subcategory.toLowerCase().includes(searchTerm.toLowerCase()));

            if (currentSort === 'price-low') filtered.sort((a, b) => a.price - b.price);
            else if (currentSort === 'price-high') filtered.sort((a, b) => b.price - a.price);
            else if (currentSort === 'popular') filtered.sort((a, b) => b.popularity - a.popularity);

            if (filtered.length === 0) {
                grid.innerHTML = '';
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
                if (currentView === 'grid') {
                    grid.className = 'grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6';
                    grid.innerHTML = filtered.map(product => createProductCard(product)).join('');
                } else {
                    grid.className = 'flex flex-col gap-4';
                    grid.innerHTML = filtered.map(product => createProductListItem(product)).join('');
                }
            }

            document.getElementById('category-count').textContent = `Showing ${filtered.length} halal-certified items`;
            setTimeout(() => {
                document.querySelectorAll('#products-grid .reveal').forEach(el => el.classList.add('active'));
                initLazyLoading();
                observeVideoContainers();
            }, 100);
        }

        function createProductCard(product) {
            const isWishlisted = wishlist.includes(product.id);
            const stockStatus = getStockStatus(product.stock);
            const hasConcentrations = product.concentrations && product.concentrations.length > 0;
            const isClothing = product.category === 'formal';
            
            return `
                <div class="product-card reveal group" data-product-id="${product.id}">
                    <div class="product-media-container mb-4 gold-border relative" id="media-${product.id}" data-product-id="${product.id}">
                        ${product.badge ? `<div class="product-badge ${product.badge === 'SALE' ? 'sale' : ''} ${product.badge === 'LIMITED' ? 'limited' : ''} ${product.badge === 'NEW' ? 'new' : ''}">${product.badge}</div>` : ''}
                        ${product.halalCertified ? `<div class="absolute top-3 right-3 bg-islamic-green/90 text-white text-[10px] font-bold px-2.5 py-1 rounded-full z-10 border border-white/20 backdrop-blur-sm"><i class="fas fa-check-circle mr-1"></i>HALAL</div>` : ''}
                        <button onclick="event.stopPropagation(); toggleWishlistItem(${product.id})" class="wishlist-btn ${isWishlisted ? 'active' : ''}" title="${isWishlisted ? 'Remove from Wishlist' : 'Add to Wishlist'}">
                            <i class="fas fa-heart ${isWishlisted ? '' : 'text-white'}"></i>
                        </button>
                        <button onclick="event.stopPropagation(); addToCart(${product.id})" class="quick-add-btn" title="Quick Add">
                            <i class="fas fa-plus"></i>
                        </button>
                        <img src="${product.image}" alt="${product.name}" class="product-poster img-loading" id="poster-${product.id}" onload="this.classList.remove('img-loading'); this.classList.add('img-loaded')">
                        <div class="video-wrapper" id="video-wrapper-${product.id}"></div>
                        <div class="video-loading" id="loading-${product.id}"><div class="loading-spinner"></div></div>
                        <button onclick="event.stopPropagation(); loadAndPlayVideo(${product.id})" class="video-facade-btn" id="play-btn-${product.id}" title="Click to play video">
                            <i class="fas fa-play ml-1"></i>
                        </button>
                        <div class="video-duration">
                            <i class="fas fa-play-circle text-xs"></i>
                            <span>${product.videoDuration || '0:15'}</span>
                        </div>
                        <div class="product-actions">
                            <button onclick="openQuickView(${product.id})" class="action-btn action-btn-secondary">
                                <i class="fas fa-eye"></i> <span class="hidden sm:inline">View</span>
                            </button>
                            <button onclick="addToCart(${product.id})" class="action-btn action-btn-primary">
                                <i class="fas fa-shopping-bag"></i> <span class="hidden sm:inline">Add</span>
                            </button>
                        </div>
                    </div>
                    <div class="space-y-2 px-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-xs text-royal font-bold uppercase tracking-wider mb-0.5">${product.brand}</p>
                                <p class="text-[10px] text-gray-600 hidden sm:block">${product.subcategory}</p>
                            </div>
                            <div class="flex items-center gap-1 bg-royal/10 px-2 py-1 rounded-full border border-royal/20">
                                <i class="fas fa-star text-royal text-[10px]"></i>
                                <span class="text-[10px] font-bold text-royal">${product.popularity}%</span>
                            </div>
                        </div>
                        <h3 class="font-display text-sm sm:text-base font-bold text-white leading-tight cursor-pointer hover:text-royal transition-colors line-clamp-2" onclick="openQuickView(${product.id})">
                            ${product.name}
                        </h3>
                        ${isClothing && product.fabric ? `<p class="text-[11px] text-gray-500 italic">${product.fabric}</p>` : ''}
                        <div class="flex items-center gap-2">
                            <span class="text-lg sm:text-xl font-bold text-royal price-tag">$${product.price}</span>
                            ${product.originalPrice ? `<span class="text-xs text-gray-600 line-through">$${product.originalPrice}</span>` : ''}
                        </div>
                        <div class="flex items-center justify-between pt-1">
                            <div class="stock-status ${stockStatus.class} text-[10px] px-2 py-0.5">
                                <i class="fas fa-circle text-[5px]"></i>
                                <span>${stockStatus.text}</span>
                            </div>
                            ${product.colors ? `
                            <div class="flex gap-1">
                                ${product.colors.slice(0, 3).map(color => `
                                    <div class="w-4 h-4 rounded-full border border-gray-700 shadow-sm" style="background: ${getColorCode(color)}" title="${color}"></div>
                                `).join('')}
                                ${product.colors.length > 3 ? `<span class="text-[10px] text-gray-600">+${product.colors.length - 3}</span>` : ''}
                            </div>
                            ` : hasConcentrations ? `
                            <div class="flex gap-1">
                                <span class="text-[10px] text-gray-600 bg-[#111] px-2 py-0.5 rounded border border-white/5">${product.concentrations[0]}</span>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function createProductListItem(product) {
            const isWishlisted = wishlist.includes(product.id);
            const hasConcentrations = product.concentrations && product.concentrations.length > 0;
            const isClothing = product.category === 'formal';
            return `
                <div class="product-card reveal flex gap-4 sm:gap-6 bg-[#111] p-4 rounded-2xl gold-border">
                    <div class="w-32 sm:w-48 h-32 sm:h-48 flex-shrink-0 relative rounded-xl overflow-hidden" data-product-id="${product.id}">
                        ${product.badge ? `<div class="product-badge ${product.badge === 'SALE' ? 'sale' : ''} ${product.badge === 'LIMITED' ? 'limited' : ''} text-xs px-2 py-0.5">${product.badge}</div>` : ''}
                        ${product.halalCertified ? `<div class="absolute top-2 right-2 bg-islamic-green/90 text-white text-[8px] font-bold px-1.5 py-0.5 rounded z-10"><i class="fas fa-check"></i></div>` : ''}
                        <img src="${product.image}" alt="${product.name}" class="product-poster w-full h-full object-cover">
                        <div class="video-wrapper" id="video-wrapper-list-${product.id}"></div>
                        <button onclick="loadAndPlayVideo(${product.id}, true)" class="video-facade-btn w-14 h-14 text-xl">
                            <i class="fas fa-play ml-1"></i>
                        </button>
                    </div>
                    <div class="flex-1 flex flex-col justify-between min-w-0">
                        <div>
                            <div class="flex justify-between items-start mb-2">
                                <div class="min-w-0 pr-2">
                                    <p class="text-xs text-royal font-bold uppercase tracking-wider mb-0.5">${product.brand}</p>
                                    <h3 class="font-display text-lg sm:text-xl font-bold text-white hover:text-royal transition-colors cursor-pointer line-clamp-2" onclick="openQuickView(${product.id})">${product.name}</h3>
                                    ${isClothing && product.fabric ? `<p class="text-xs text-gray-500 italic mt-1">${product.fabric}</p>` : ''}
                                </div>
                                <button onclick="toggleWishlistItem(${product.id})" class="text-xl ${isWishlisted ? 'text-red-500' : 'text-gray-700'} hover:scale-110 transition-transform flex-shrink-0">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                            <p class="text-gray-500 text-sm mb-3 line-clamp-2">${product.description}</p>
                            <div class="flex items-center gap-3 mb-3">
                                <span class="text-xl font-bold text-royal">$${product.price}</span>
                                ${product.originalPrice ? `<span class="text-gray-600 line-through text-sm">$${product.originalPrice}</span>` : ''}
                            </div>
                            <div class="flex flex-wrap gap-2">
                                ${product.sizes ? product.sizes.map(size => `<span class="px-2.5 py-1 bg-[#1a1a1a] rounded-lg text-xs border border-white/5 text-gray-400">${size}</span>`).join('') : 
                                  hasConcentrations ? product.concentrations.map(c => `<span class="px-2.5 py-1 bg-[#1a1a1a] rounded-lg text-xs border border-white/5 text-gray-400">${c}</span>`).join('') : ''}
                            </div>
                        </div>
                        <div class="flex gap-3 mt-4">
                            <button onclick="openQuickView(${product.id})" class="px-5 py-2.5 border border-white/10 rounded-full text-sm font-bold hover:border-royal/30 hover:text-royal transition-all bg-white/5">
                                <i class="fas fa-eye mr-2"></i>View
                            </button>
                            <button onclick="addToCart(${product.id})" class="flex-1 px-5 py-2.5 bg-gradient-to-r from-royal to-royal-dark text-black rounded-full text-sm font-bold hover:from-royal-light hover:to-royal transition-all">
                                <i class="fas fa-shopping-bag mr-2"></i>Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function observeVideoContainers() {
            document.querySelectorAll('.product-media-container[data-product-id]').forEach(container => {
                videoIntersectionObserver.observe(container);
            });
        }

        function loadAndPlayVideo(productId, isListView = false) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const wrapperId = isListView ? `video-wrapper-list-${productId}` : `video-wrapper-${productId}`;
            const wrapper = document.getElementById(wrapperId);
            const playBtn = document.getElementById(`play-btn-${productId}`);
            const loading = document.getElementById(`loading-${productId}`);
            const poster = document.getElementById(`poster-${productId}`);

            if (!wrapper || loadedVideos.has(productId)) return;

            if (loading) loading.classList.add('active');
            if (playBtn) playBtn.classList.add('playing');

            const iframe = document.createElement('iframe');
            iframe.className = 'tiktok-iframe';
            iframe.allow = 'fullscreen; autoplay; clipboard-write; encrypted-media; picture-in-picture';
            iframe.setAttribute('loading', 'lazy');
            iframe.title = `${product.name} Video`;
            iframe.src = getTikTokEmbedUrl(product.tiktokVideoId, product.tiktokUsername, true);
            
            iframe.onload = () => {
                loadedVideos.add(productId);
                if (loading) loading.classList.remove('active');
                wrapper.classList.add('active');
                if (poster) poster.style.opacity = '0';
            };

            iframe.onerror = () => {
                if (loading) loading.classList.remove('active');
                if (playBtn) playBtn.classList.remove('playing');
                showToast('Video unavailable', 'exclamation-circle');
            };

            wrapper.innerHTML = '';
            wrapper.appendChild(iframe);

            setTimeout(() => {
                if (!loadedVideos.has(productId) && loading) loading.classList.remove('active');
            }, 10000);
        }

        function getStockStatus(stock) {
            if (stock === 0) return { class: 'out', text: 'Out of Stock' };
            if (stock <= 5) return { class: 'low', text: `${stock} left` };
            if (stock <= 10) return { class: 'low', text: 'Low Stock' };
            return { class: '', text: 'In Stock' };
        }

        function getColorCode(colorName) {
            const colors = { 'Black': '#000000', 'White': '#FFFFFF', 'Grey': '#808080', 'Navy': '#000080', 'Red': '#FF0000', 'Blue': '#0000FF', 'Green': '#008000', 'Olive': '#808000', 'Brown': '#8B4513', 'Beige': '#F5F5DC', 'Khaki': '#C3B091', 'Pink': '#FFC0CB', 'Yellow': '#FFFF00', 'Orange': '#FFA500', 'Purple': '#800080', 'Tan': '#D2B48C', 'Dark Brown': '#654321', 'Black Gold': '#000000', 'Brown Gold': '#8B4513', 'Clear': '#E0F7FA', 'Amber': '#FFBF00', 'Off-White': '#FAF9F6', 'Ivory': '#FFFFF0', 'Cream': '#FFFDD0', 'Light Grey': '#D3D3D3', 'Charcoal': '#36454F', 'Royal Blue': '#4169E1', 'Burgundy': '#800020', 'Maroon': '#800000' };
            return colors[colorName] || '#888888';
        }

        function initLazyLoading() {
            const images = document.querySelectorAll('.product-poster');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        if (img.dataset.src) { img.src = img.dataset.src; img.removeAttribute('data-src'); }
                        observer.unobserve(img);
                    }
                });
            }, { rootMargin: '50px' });
            images.forEach(img => imageObserver.observe(img));
        }

        function filterCategory(category) {
            currentCategory = category;
            document.querySelectorAll('.category-pill').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.category === category);
                if (btn.dataset.category === category) btn.classList.remove('text-gray-400');
                else btn.classList.add('text-gray-400');
            });
            renderProducts(category);
            updateCategoryTitle();
            document.getElementById('products').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function updateCategoryTitle() {
            const titles = { 
                'all': 'All Islamic Collection', 
                'formal': 'Official Formal Wear',
                'perfumes': 'Premium Perfumes', 
                'shoes': 'Islamic Footwear', 
                'attars': 'Attars & Oils', 
                'essentials': 'Islamic Essentials' 
            };
            document.getElementById('category-title').textContent = titles[currentCategory] || titles['all'];
        }

        function sortProducts(sortType) {
            currentSort = sortType;
            renderProducts(currentCategory, document.getElementById('search-input').value);
        }

        function setView(view) {
            currentView = view;
            document.getElementById('grid-view-btn').classList.toggle('active', view === 'grid');
            document.getElementById('grid-view-btn').classList.toggle('text-gray-400', view !== 'grid');
            document.getElementById('list-view-btn').classList.toggle('active', view === 'list');
            document.getElementById('list-view-btn').classList.toggle('text-gray-400', view !== 'list');
            renderProducts(currentCategory, document.getElementById('search-input').value);
        }

        function filterProducts() {
            renderProducts(currentCategory, document.getElementById('search-input').value);
        }

        function toggleSearch() {
            const bar = document.getElementById('search-bar');
            bar.classList.toggle('hidden');
            if (!bar.classList.contains('hidden')) {
                setTimeout(() => document.getElementById('search-input').focus(), 100);
            }
        }

        function toggleWishlist() {
            const sidebar = document.getElementById('wishlist-sidebar');
            const overlay = document.getElementById('wishlist-overlay');
            const isOpen = sidebar.classList.contains('open');
            if (isOpen) {
                sidebar.classList.remove('open');
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
            } else {
                sidebar.classList.add('open');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                updateWishlistUI();
            }
        }

        function toggleWishlistItem(productId) {
            const index = wishlist.indexOf(productId);
            if (index > -1) {
                wishlist.splice(index, 1);
                showToast('Removed from wishlist', 'heart-broken');
            } else {
                wishlist.push(productId);
                showToast('Added to wishlist!', 'heart');
            }
            saveToLocalStorage();
            updateWishlistUI();
            renderProducts(currentCategory, document.getElementById('search-input').value);
        }

        function updateWishlistUI() {
            const count = document.getElementById('wishlist-count');
            const totalItems = document.getElementById('wishlist-total-items');
            const items = document.getElementById('wishlist-items');

            count.textContent = wishlist.length;
            count.classList.toggle('scale-0', wishlist.length === 0);
            count.classList.toggle('scale-100', wishlist.length > 0);
            totalItems.textContent = wishlist.length;

            if (wishlist.length === 0) {
                items.innerHTML = `
                    <div class="text-center text-gray-500 py-16">
                        <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/5 flex items-center justify-center">
                            <i class="fas fa-heart text-4xl opacity-20"></i>
                        </div>
                        <p class="text-lg mb-3 font-medium">Your wishlist is empty</p>
                        <button onclick="toggleWishlist(); document.getElementById('products').scrollIntoView({behavior: 'smooth'})" class="text-royal hover:text-royal-light transition-colors font-medium text-sm">Discover Products</button>
                    </div>
                `;
            } else {
                const wishlistProducts = products.filter(p => wishlist.includes(p.id));
                items.innerHTML = wishlistProducts.map(item => `
                    <div class="cart-item flex gap-4 bg-[#1a1a1a] rounded-xl p-4 border border-white/5">
                        <img src="${item.image}" alt="${item.name}" class="w-20 sm:w-24 h-20 sm:h-24 object-cover rounded-lg border border-white/5">
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start mb-1">
                                <div>
                                    <p class="text-xs text-royal font-bold mb-0.5">${item.brand}</p>
                                    <h4 class="font-bold text-sm truncate pr-2">${item.name}</h4>
                                </div>
                                <button onclick="toggleWishlistItem(${item.id})" class="text-gray-600 hover:text-red-500 transition-colors p-1">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                            <p class="text-royal font-bold mb-3">$${item.price}</p>
                            <button onclick="addToCart(${item.id}); toggleWishlistItem(${item.id})" class="w-full py-2 bg-royal/10 text-royal rounded-lg text-xs font-bold hover:bg-royal hover:text-black transition-all border border-royal/20">
                                <i class="fas fa-shopping-bag mr-2"></i>Move to Cart
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const existing = cart.find(item => item.id === productId);
            const selectedColor = selectedColors[productId] || (product.colors ? product.colors[0] : null);
            const selectedConcentration = selectedConcentrations[productId] || (product.concentrations ? product.concentrations[0] : null);

            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ 
                    ...product, 
                    quantity: 1, 
                    selectedSize: product.sizes ? product.sizes[0] : null, 
                    selectedColor: selectedColor,
                    selectedConcentration: selectedConcentration
                });
            }

            saveToLocalStorage();
            updateCartUI();
            showToast('Added to cart!');
            
            const cartIcon = document.querySelector('.fa-shopping-bag').parentElement;
            cartIcon.classList.add('animate-bounce');
            setTimeout(() => cartIcon.classList.remove('animate-bounce'), 1000);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveToLocalStorage();
            updateCartUI();
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) removeFromCart(productId);
                else { saveToLocalStorage(); updateCartUI(); }
            }
        }

        function updateSize(productId, size) {
            const item = cart.find(item => item.id === productId);
            if (item) { item.selectedSize = size; saveToLocalStorage(); }
        }

        function updateCartUI() {
            const count = document.getElementById('cart-count');
            const totalItems = document.getElementById('cart-total-items');
            const items = document.getElementById('cart-items');
            const subtotal = document.getElementById('cart-subtotal');
            const tax = document.getElementById('cart-tax');
            const total = document.getElementById('cart-total');

            const totalQty = cart.reduce((sum, item) => sum + item.quantity, 0);
            const subtotalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const taxPrice = subtotalPrice * 0.08;
            const totalPrice = subtotalPrice + taxPrice;

            count.textContent = totalQty;
            count.classList.toggle('scale-0', totalQty === 0);
            count.classList.toggle('scale-100', totalQty > 0);
            totalItems.textContent = totalQty;

            if (cart.length === 0) {
                items.innerHTML = `
                    <div class="text-center text-gray-500 py-16">
                        <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/5 flex items-center justify-center">
                            <i class="fas fa-mosque text-4xl opacity-20"></i>
                        </div>
                        <p class="text-lg mb-3 font-medium">Your cart is empty</p>
                        <button onclick="toggleCart(); document.getElementById('products').scrollIntoView({behavior: 'smooth'})" class="text-royal hover:text-royal-light transition-colors font-medium text-sm">Start Shopping</button>
                    </div>
                `;
            } else {
                items.innerHTML = cart.map(item => `
                    <div class="cart-item flex gap-4 bg-[#1a1a1a] rounded-xl p-4 border border-white/5 hover:border-royal/20 transition-colors">
                        <img src="${item.image}" alt="${item.name}" class="w-20 sm:w-24 h-20 sm:h-24 object-cover rounded-lg border border-white/5">
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start mb-1">
                                <div>
                                    <p class="text-xs text-royal font-bold mb-0.5">${item.brand}</p>
                                    <h4 class="font-bold text-sm truncate pr-2">${item.name}</h4>
                                    ${item.selectedColor ? `<span class="text-xs text-gray-500">Color: ${item.selectedColor}</span>` : ''}
                                    ${item.selectedConcentration ? `<span class="text-xs text-gray-500 block">Type: ${item.selectedConcentration}</span>` : ''}
                                </div>
                                <button onclick="removeFromCart(${item.id})" class="text-gray-600 hover:text-red-500 transition-colors p-1">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                            ${item.sizes ? `
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-xs text-gray-500">Size:</span>
                                <select onchange="updateSize(${item.id}, this.value)" class="bg-[#111] border border-white/10 rounded text-xs px-2 py-1 focus:border-royal outline-none">
                                    ${item.sizes.map(size => `<option value="${size}" ${size === item.selectedSize ? 'selected' : ''}>${size}</option>`).join('')}
                                </select>
                            </div>
                            ` : ''}
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-1 bg-[#111] rounded-lg p-1 border border-white/5">
                                    <button onclick="updateQuantity(${item.id}, -1)" class="qty-btn text-gray-400 hover:text-black text-xs w-7 h-7">-</button>
                                    <span class="w-6 text-center font-bold text-sm">${item.quantity}</span>
                                    <button onclick="updateQuantity(${item.id}, 1)" class="qty-btn text-gray-400 hover:text-black text-xs w-7 h-7">+</button>
                                </div>
                                <p class="font-bold text-royal text-base">$${(item.price * item.quantity).toLocaleString()}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            subtotal.textContent = `$${subtotalPrice.toLocaleString()}.00`;
            tax.textContent = `$${taxPrice.toLocaleString()}.00`;
            total.textContent = `$${totalPrice.toLocaleString()}.00`;
        }

        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            const isOpen = sidebar.classList.contains('open');
            if (isOpen) {
                sidebar.classList.remove('open');
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
            } else {
                sidebar.classList.add('open');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                updateCartUI();
            }
        }

        function checkoutWhatsApp() {
            if (cart.length === 0) { showToast('Your cart is empty!', 'exclamation-circle'); return; }

            const phone = '+254704918499';
            let message = ` *ROYAL ISLAMIC ORDER*%0A%0A`;
            cart.forEach((item, i) => {
                message += `*${i + 1}. ${item.name}*%0A`;
                message += `   Brand: ${item.brand}%0A`;
                message += `   Category: ${item.category}%0A`;
                if (item.selectedSize) message += `   Size: ${item.selectedSize}%0A`;
                if (item.selectedColor) message += `   Color: ${item.selectedColor}%0A`;
                if (item.selectedConcentration) message += `   Type: ${item.selectedConcentration}%0A`;
                message += `   Qty: ${item.quantity}%0A`;
                message += `   Price: $${(item.price * item.quantity).toLocaleString()}%0A%0A`;
            });

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = total * 0.08;
            message += `*Subtotal: $${total.toLocaleString()}*%0A`;
            message += `*Tax (8%): $${tax.toLocaleString()}*%0A`;
            message += `*TOTAL: $${(total + tax).toLocaleString()}*%0A%0A`;
            message += `Jazakallah Khair! `;

            window.open(`https://wa.me/${phone}?text=${message}`, '_blank');
        }

        function showWhatsAppChat() {
            window.open(`https://wa.me/+254704918499?text= As-salamu alaykum! I'm interested in your Islamic products.`, '_blank');
        }

        function openQuickView(productId) {
            const product = products.find(p => p.id === productId);
            const modal = document.getElementById('quick-view-modal');
            const content = document.getElementById('modal-content');
            const isWishlisted = wishlist.includes(productId);
            const hasConcentrations = product.concentrations && product.concentrations.length > 0;
            const isClothing = product.category === 'formal';

            content.innerHTML = `
                <div class="h-[300px] sm:h-[400px] md:h-[600px] bg-[#111] relative">
                    <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover" id="modal-poster">
                    <div class="video-wrapper" id="modal-video-wrapper"></div>
                    <button onclick="loadModalVideo(${product.id})" class="video-facade-btn" id="modal-play-btn" style="opacity: 1; transform: translate(-50%, -50%) scale(1);">
                        <i class="fas fa-play ml-1"></i>
                    </button>
                    <div class="absolute bottom-4 right-4 bg-black/80 text-royal px-4 py-2 rounded-full text-xs font-bold border border-royal/20 backdrop-blur-sm">
                        <i class="fas fa-video mr-2"></i> Product Video
                    </div>
                    ${product.halalCertified ? `<div class="absolute top-4 left-4 bg-islamic-green/90 text-white px-4 py-2 rounded-lg text-sm font-bold border border-white/20 flex items-center gap-2"><i class="fas fa-check-circle"></i> HALAL CERTIFIED</div>` : ''}
                    <button onclick="toggleWishlistItem(${product.id}); openQuickView(${product.id})" class="absolute top-4 right-4 w-12 h-12 rounded-full ${isWishlisted ? 'bg-red-500' : 'bg-black/50'} flex items-center justify-center text-white hover:scale-110 transition-transform backdrop-blur-sm border border-white/20">
                        <i class="fas fa-heart"></i>
                    </button>
                </div>
                <div class="p-6 sm:p-8 md:p-12 space-y-6 overflow-y-auto max-h-[400px] sm:max-h-[600px]">
                    <div>
                        <div class="flex items-center gap-3 mb-3 flex-wrap">
                            <span class="text-royal font-bold tracking-wider uppercase text-xs">${product.brand}</span>
                            <span class="text-gray-600 text-xs"> ${product.subcategory}</span>
                            ${product.badge ? `<span class="bg-royal/10 text-royal text-xs font-bold px-3 py-1 rounded-full border border-royal/20">${product.badge}</span>` : ''}
                        </div>
                        <h2 class="font-display text-2xl sm:text-3xl md:text-4xl font-bold mb-4 leading-tight">${product.name}</h2>
                        <div class="flex items-center gap-4 mb-6 flex-wrap">
                            <span class="text-3xl sm:text-4xl font-bold text-royal">$${product.price}</span>
                            ${product.originalPrice ? `<span class="text-xl text-gray-600 line-through">$${product.originalPrice}</span>` : ''}
                            <div class="stock-status ${getStockStatus(product.stock).class} ml-auto">
                                <i class="fas fa-circle text-[6px]"></i>
                                <span>${getStockStatus(product.stock).text}</span>
                            </div>
                        </div>
                        <p class="text-gray-400 leading-relaxed text-base">${product.description}</p>
                        ${isClothing && product.fabric ? `<p class="text-sm text-royal mt-3"><i class="fas fa-tshirt mr-2"></i>Fabric: ${product.fabric}</p>` : ''}
                    </div>

                    ${hasConcentrations ? `
                    <div>
                        <p class="font-bold mb-3 text-xs uppercase tracking-wider text-gray-500">Select Type</p>
                        <div class="flex flex-wrap gap-2">
                            ${product.concentrations.map((conc, i) => `
                                <button onclick="selectConcentration(${product.id}, '${conc}', this)" class="px-4 py-2 rounded-full border-2 ${i === 0 ? 'border-royal bg-royal text-black font-bold' : 'border-white/10 text-gray-400 hover:border-royal/50'} transition-all text-sm">${conc}</button>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}

                    ${product.colors ? `
                    <div>
                        <p class="font-bold mb-3 text-xs uppercase tracking-wider text-gray-500">Select Color</p>
                        <div class="flex gap-3">
                            ${product.colors.map((color, i) => `
                                <button onclick="selectColor(${product.id}, '${color}', this)" class="color-swatch ${i === 0 ? 'selected' : ''}" style="background: ${getColorCode(color)}" title="${color}"></button>
                            `).join('')}
                        </div>
                        <p class="text-sm text-gray-500 mt-3" id="selected-color-text">Selected: ${product.colors[0]}</p>
                    </div>
                    ` : ''}

                    ${product.sizes ? `
                    <div>
                        <p class="font-bold mb-3 text-xs uppercase tracking-wider text-gray-500">Select Size</p>
                        <div class="flex flex-wrap gap-2">
                            ${product.sizes.map((size, i) => `
                                <button onclick="selectSize(this)" class="size-btn w-12 h-12 rounded-xl font-bold text-sm ${i === 0 ? 'selected' : ''}">${size}</button>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}

                    <div class="flex flex-col sm:flex-row gap-3 pt-4">
                        <button onclick="addToCartFromModal(${product.id}); closeQuickView();" class="btn-primary flex-1 bg-gradient-to-r from-royal to-royal-dark text-black font-bold py-4 rounded-full hover:from-royal-light hover:to-royal transition-all flex items-center justify-center gap-3 text-base shadow-lg shadow-royal/20 hover:shadow-royal/40 transform hover:scale-[1.02]">
                            <i class="fas fa-shopping-bag"></i> Add to Cart
                        </button>
                        <button onclick="buyNow(${product.id})" class="flex-1 border-2 border-royal text-royal font-bold py-4 rounded-full hover:bg-royal hover:text-black transition-all flex items-center justify-center gap-3 text-base">
                            <i class="fab fa-whatsapp"></i> Buy Now
                        </button>
                    </div>

                    <div class="grid grid-cols-3 gap-4 pt-6 border-t border-white/5 text-center">
                        <div class="text-gray-500">
                            <i class="fas fa-certificate text-royal mb-2 text-xl"></i>
                            <p class="text-xs">Halal</p>
                        </div>
                        <div class="text-gray-500">
                            <i class="fas fa-truck text-royal mb-2 text-xl"></i>
                            <p class="text-xs">Free Ship</p>
                        </div>
                        <div class="text-gray-500">
                            <i class="fas fa-undo text-royal mb-2 text-xl"></i>
                            <p class="text-xs">Returns</p>
                        </div>
                    </div>
                </div>
            `;

            if (product.colors) selectedColors[productId] = product.colors[0];
            if (product.concentrations) selectedConcentrations[productId] = product.concentrations[0];
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function loadModalVideo(productId) {
            const product = products.find(p => p.id === productId);
            const wrapper = document.getElementById('modal-video-wrapper');
            const playBtn = document.getElementById('modal-play-btn');
            const poster = document.getElementById('modal-poster');

            if (!wrapper || loadedVideos.has(`modal-${productId}`)) return;

            playBtn.style.opacity = '0';
            playBtn.style.pointerEvents = 'none';

            const iframe = document.createElement('iframe');
            iframe.className = 'tiktok-iframe';
            iframe.allow = 'fullscreen; autoplay';
            iframe.src = getTikTokEmbedUrl(product.tiktokVideoId, product.tiktokUsername, true);
            
            iframe.onload = () => {
                loadedVideos.add(`modal-${productId}`);
                wrapper.classList.add('active');
                if (poster) poster.style.opacity = '0';
            };

            wrapper.innerHTML = '';
            wrapper.appendChild(iframe);
        }

        function selectColor(productId, color, btn) {
            selectedColors[productId] = color;
            document.querySelectorAll('.color-swatch').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            const text = document.getElementById('selected-color-text');
            if (text) text.textContent = `Selected: ${color}`;
        }

        function selectConcentration(productId, concentration, btn) {
            selectedConcentrations[productId] = concentration;
            btn.parentElement.querySelectorAll('button').forEach(b => {
                b.classList.remove('border-royal', 'bg-royal', 'text-black', 'font-bold');
                b.classList.add('border-white/10', 'text-gray-400');
            });
            btn.classList.remove('border-white/10', 'text-gray-400');
            btn.classList.add('border-royal', 'bg-royal', 'text-black', 'font-bold');
        }

        function addToCartFromModal(productId) {
            const selectedSize = document.querySelector('.size-btn.selected')?.textContent;
            const product = products.find(p => p.id === productId);
            const existing = cart.find(item => item.id === productId && item.selectedSize === selectedSize);
            
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ 
                    ...product, 
                    quantity: 1, 
                    selectedSize: selectedSize || (product.sizes ? product.sizes[0] : null), 
                    selectedColor: selectedColors[productId] || (product.colors ? product.colors[0] : null),
                    selectedConcentration: selectedConcentrations[productId] || (product.concentrations ? product.concentrations[0] : null)
                });
            }
            
            saveToLocalStorage();
            updateCartUI();
            showToast('Added to cart!');
        }

        function closeQuickView() {
            document.getElementById('quick-view-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function selectSize(btn) {
            document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function buyNow(productId) {
            const product = products.find(p => p.id === productId);
            const selectedSize = document.querySelector('.size-btn.selected')?.textContent || (product.sizes ? product.sizes[0] : null);
            const selectedColor = selectedColors[productId] || (product.colors ? product.colors[0] : null);
            const selectedConcentration = selectedConcentrations[productId] || (product.concentrations ? product.concentrations[0] : null);
            const phone = '+254704918499';
            
            let message = ` *Quick Order - ROYAL Islamic*%0A%0A*${product.name}*%0ABrand: ${product.brand}%0ACategory: ${product.category}`;
            if (selectedSize) message += `%0ASize: ${selectedSize}`;
            if (selectedColor) message += `%0AColor: ${selectedColor}`;
            if (selectedConcentration) message += `%0AType: ${selectedConcentration}`;
            message += `%0APrice: $${product.price}%0A%0APlease confirm availability. Jazakallah Khair!`;
            
            window.open(`https://wa.me/${phone}?text=${message}`, '_blank');
        }

        function openTikTokFullscreen(videoId, username) {
            const modal = document.getElementById('tiktok-modal');
            const container = document.getElementById('modal-video-container');
            container.innerHTML = `<iframe src="${getTikTokEmbedUrl(videoId, username, true)}" allow="fullscreen; autoplay" style="width: 100%; height: 100%; border: none; border-radius: 1rem;"></iframe>`;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeTikTokModal(e) {
            if (e && e.target !== e.currentTarget) return;
            const modal = document.getElementById('tiktok-modal');
            const container = document.getElementById('modal-video-container');
            container.innerHTML = '';
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function showToast(message = 'Added to cart!', icon = 'mosque') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = toast.querySelector('i');
            
            toastMessage.textContent = message;
            toastIcon.className = `fas fa-${icon} text-xl`;
            
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function initScrollReveal() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
        }

        function initStickyNav() {
            const nav = document.getElementById('category-nav');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) nav.classList.add('sticky-active');
                    else nav.classList.remove('sticky-active');
                });
            }, { threshold: 0 });
            observer.observe(document.getElementById('products'));
        }

        document.getElementById('quick-view-modal').addEventListener('click', (e) => {
            if (e.target.id === 'quick-view-modal') closeQuickView();
        });

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        function loadMoreProducts() {
            const btn = document.getElementById('load-more-btn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Loading...';
            setTimeout(() => {
                btn.innerHTML = '<i class="fas fa-check mr-2"></i> All Items Loaded';
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
            }, 1000);
        }

        window.addEventListener('scroll', () => {
            const nav = document.getElementById('navbar');
            if (window.scrollY > 50) nav.classList.add('glass-strong');
            else nav.classList.remove('glass-strong');
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeQuickView();
                closeTikTokModal();
                if (document.getElementById('cart-sidebar').classList.contains('open')) toggleCart();
                if (document.getElementById('wishlist-sidebar').classList.contains('open')) toggleWishlist();
            }
            if (e.key === '/' && document.activeElement.tagName !== 'INPUT') {
                e.preventDefault();
                toggleSearch();
            }
        });

        window.addEventListener('beforeunload', () => {
            if (videoIntersectionObserver) videoIntersectionObserver.disconnect();
        });
    </script>
</body>
</html>